<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Flowgrind: src/fg_rpc_server.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="flowgrind.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Flowgrind
   </div>
   <div id="projectbrief">Advanced TCP traffic generator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('fg__rpc__server_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">fg_rpc_server.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Flowgrindd rpcserver implementation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="config_8h_source.html">config.h</a>&quot;</code><br />
<code>#include &lt;sys/utsname.h&gt;</code><br />
<code>#include &lt;syslog.h&gt;</code><br />
<code>#include &quot;<a class="el" href="common_8h_source.html">common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="daemon_8h_source.html">daemon.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fg__log_8h_source.html">fg_log.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fg__error_8h_source.html">fg_error.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fg__definitions_8h_source.html">fg_definitions.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="debug_8h_source.html">debug.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fg__rpc__server_8h_source.html">fg_rpc_server.h</a>&quot;</code><br />
</div>
<p><a href="fg__rpc__server_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad1401628a7594a7835fcdfabefefd689"><td class="memItemLeft" align="right" valign="top">static xmlrpc_value *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fg__rpc__server_8c.html#ad1401628a7594a7835fcdfabefefd689">add_flow_destination</a> (xmlrpc_env *const env, xmlrpc_value *const param_array, void *const user_data)</td></tr>
<tr class="memdesc:ad1401628a7594a7835fcdfabefefd689"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare data connection for destination endpoint.  <a href="#ad1401628a7594a7835fcdfabefefd689">More...</a><br /></td></tr>
<tr class="separator:ad1401628a7594a7835fcdfabefefd689"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55fd54a0087dd0ac821433cbda1f65bd"><td class="memItemLeft" align="right" valign="top">static xmlrpc_value *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fg__rpc__server_8c.html#a55fd54a0087dd0ac821433cbda1f65bd">add_flow_source</a> (xmlrpc_env *const env, xmlrpc_value *const param_array, void *const user_data)</td></tr>
<tr class="memdesc:a55fd54a0087dd0ac821433cbda1f65bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare data connection for source endpoint.  <a href="#a55fd54a0087dd0ac821433cbda1f65bd">More...</a><br /></td></tr>
<tr class="separator:a55fd54a0087dd0ac821433cbda1f65bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2328283204a516f2fd89f05f7818189d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fg__rpc__server_8c.html#a2328283204a516f2fd89f05f7818189d">bind_rpc_server</a> (char *bind_addr, unsigned <a class="el" href="flowgrindd_8c.html#a93a340e516c0d6c60f5826ee5f498e21">port</a>)</td></tr>
<tr class="separator:a2328283204a516f2fd89f05f7818189d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0084c304767d8403123e53f562c7cbb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fg__rpc__server_8c.html#ad0084c304767d8403123e53f562c7cbb">init_rpc_server</a> (struct <a class="el" href="structfg__rpc__server.html">fg_rpc_server</a> *server, char *<a class="el" href="flowgrindd_8c.html#a38267260bb75d9914c4d82d7a5aa4cd5">rpc_bind_addr</a>, unsigned <a class="el" href="flowgrindd_8c.html#a93a340e516c0d6c60f5826ee5f498e21">port</a>)</td></tr>
<tr class="memdesc:ad0084c304767d8403123e53f562c7cbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the xmlrpc server.  <a href="#ad0084c304767d8403123e53f562c7cbb">More...</a><br /></td></tr>
<tr class="separator:ad0084c304767d8403123e53f562c7cbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a704160b94299ac9000d1c48c41d866a5"><td class="memItemLeft" align="right" valign="top">static xmlrpc_value *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fg__rpc__server_8c.html#a704160b94299ac9000d1c48c41d866a5">method_get_reports</a> (xmlrpc_env *const env, xmlrpc_value *const param_array, void *const user_data)</td></tr>
<tr class="memdesc:a704160b94299ac9000d1c48c41d866a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">To get the reports from the daemon.  <a href="#a704160b94299ac9000d1c48c41d866a5">More...</a><br /></td></tr>
<tr class="separator:a704160b94299ac9000d1c48c41d866a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82089af015ac3c47e11de91d23ee09a3"><td class="memItemLeft" align="right" valign="top">static xmlrpc_value *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fg__rpc__server_8c.html#a82089af015ac3c47e11de91d23ee09a3">method_get_status</a> (xmlrpc_env *const env, xmlrpc_value *const param_array, void *const user_data)</td></tr>
<tr class="separator:a82089af015ac3c47e11de91d23ee09a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b6b9e3fdcd13d429b8a223e68a88477"><td class="memItemLeft" align="right" valign="top">static xmlrpc_value *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fg__rpc__server_8c.html#a0b6b9e3fdcd13d429b8a223e68a88477">method_get_uuid</a> (xmlrpc_env *const env, xmlrpc_value *const param_array, void *const user_data)</td></tr>
<tr class="memdesc:a0b6b9e3fdcd13d429b8a223e68a88477"><td class="mdescLeft">&#160;</td><td class="mdescRight">To get the daemons UUID.  <a href="#a0b6b9e3fdcd13d429b8a223e68a88477">More...</a><br /></td></tr>
<tr class="separator:a0b6b9e3fdcd13d429b8a223e68a88477"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3418ca5436aaeb5b83c53ae80752329"><td class="memItemLeft" align="right" valign="top">static xmlrpc_value *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fg__rpc__server_8c.html#ae3418ca5436aaeb5b83c53ae80752329">method_get_version</a> (xmlrpc_env *const env, xmlrpc_value *const param_array, void *const user_data)</td></tr>
<tr class="separator:ae3418ca5436aaeb5b83c53ae80752329"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ed767ac2965ae35b09e74b50b2ba9a5"><td class="memItemLeft" align="right" valign="top">static xmlrpc_value *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fg__rpc__server_8c.html#a1ed767ac2965ae35b09e74b50b2ba9a5">method_stop_flow</a> (xmlrpc_env *const env, xmlrpc_value *const param_array, void *const user_data)</td></tr>
<tr class="separator:a1ed767ac2965ae35b09e74b50b2ba9a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf5fc98d4e3624c681e18494a085db84"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fg__rpc__server_8c.html#abf5fc98d4e3624c681e18494a085db84">run_rpc_server</a> (struct <a class="el" href="structfg__rpc__server.html">fg_rpc_server</a> *server)</td></tr>
<tr class="memdesc:abf5fc98d4e3624c681e18494a085db84"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enters the xmlrpc server mainloop.  <a href="#abf5fc98d4e3624c681e18494a085db84">More...</a><br /></td></tr>
<tr class="separator:abf5fc98d4e3624c681e18494a085db84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa474434b5dc6f7e1a4ca9af98382c37f"><td class="memItemLeft" align="right" valign="top">static xmlrpc_value *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fg__rpc__server_8c.html#aa474434b5dc6f7e1a4ca9af98382c37f">start_flows</a> (xmlrpc_env *const env, xmlrpc_value *const param_array, void *const user_data)</td></tr>
<tr class="separator:aa474434b5dc6f7e1a4ca9af98382c37f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Flowgrindd rpcserver implementation. </p>

<p>Definition in file <a class="el" href="fg__rpc__server_8c_source.html">fg_rpc_server.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ad1401628a7594a7835fcdfabefefd689"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static xmlrpc_value* add_flow_destination </td>
          <td>(</td>
          <td class="paramtype">xmlrpc_env *const&#160;</td>
          <td class="paramname"><em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">xmlrpc_value *const&#160;</td>
          <td class="paramname"><em>param_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *const&#160;</td>
          <td class="paramname"><em>user_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prepare data connection for destination endpoint. </p>
<p>Flowgrind rpc server decode the information from the controller XML-RPC and construct the request data structure to add flow in the destination daemon. The request is dispatched to destination daemon. The destination daemon execute the request and send back the executed result in the request reply to the flowgrind rpc server. Flowgrind rpc server then encode the request reply information from the daemon and send back the data to the flowgrind controller through XML-RPC connection</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">env</td><td>XML-RPC environment object </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">param_array</td><td>XML-RPC value </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user_data</td><td>unused arg return xmlrpc_value XML-RPC value </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="fg__rpc__server_8c_source.html#l00277">277</a> of file <a class="el" href="fg__rpc__server_8c_source.html">fg_rpc_server.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;{</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <a class="code" href="fg__definitions_8h.html#a239dd5192fcd165ce89d2c6d08e34993">UNUSED_ARGUMENT</a>(user_data);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keywordtype">int</span> rc, i;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        xmlrpc_value *ret = 0;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordtype">char</span>* cc_alg = 0;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="keywordtype">char</span>* bind_address = 0;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        xmlrpc_value* extra_options = 0;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="keyword">struct </span><a class="code" href="structflow__settings.html">flow_settings</a> settings;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keyword">struct </span><a class="code" href="structrequest__add__flow__destination.html">request_add_flow_destination</a>* <a class="code" href="structrequest.html">request</a> = 0;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_WARNING, <span class="stringliteral">&quot;method add_flow_destination called&quot;</span>);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="comment">/* Parse our argument array. */</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        xmlrpc_decompose_value(env, param_array,</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                <span class="stringliteral">&quot;(&quot;</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                <span class="stringliteral">&quot;{s:s,*}&quot;</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                <span class="stringliteral">&quot;{s:i,*}&quot;</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                <span class="stringliteral">&quot;{s:d,s:d,s:d,s:d,s:d,*}&quot;</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                <span class="stringliteral">&quot;{s:i,s:i,*}&quot;</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                <span class="stringliteral">&quot;{s:i,*}&quot;</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                <span class="stringliteral">&quot;{s:b,s:b,s:b,s:b,s:b,*}&quot;</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                <span class="stringliteral">&quot;{s:i,s:i,*}&quot;</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                <span class="stringliteral">&quot;{s:i,s:d,s:d,*}&quot;</span> <span class="comment">/* request */</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                <span class="stringliteral">&quot;{s:i,s:d,s:d,*}&quot;</span> <span class="comment">/* response */</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                <span class="stringliteral">&quot;{s:i,s:d,s:d,*}&quot;</span> <span class="comment">/* interpacket_gap */</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                <span class="stringliteral">&quot;{s:b,s:b,s:i,s:i,*}&quot;</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                <span class="stringliteral">&quot;{s:s,*}&quot;</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                <span class="stringliteral">&quot;{s:i,s:i,s:i,s:i,s:i,*}&quot;</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                <span class="stringliteral">&quot;{s:s,*}&quot;</span> <span class="comment">/* For libpcap dumps */</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                <span class="stringliteral">&quot;{s:i,s:A,*}&quot;</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                <span class="stringliteral">&quot;)&quot;</span>,</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                <span class="comment">/* general settings */</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                <span class="stringliteral">&quot;bind_address&quot;</span>, &amp;bind_address,</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                <span class="stringliteral">&quot;flow_id&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a1144784676f7ead2cf557fa96838ddb2">flow_id</a>,</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                </div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                <span class="stringliteral">&quot;write_delay&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a65188cf299b16d1dbc05ceba51d2328a">delay</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>],</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                <span class="stringliteral">&quot;write_duration&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a4f29273c21baece6aabd20a46efdc0c8">duration</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>],</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                <span class="stringliteral">&quot;read_delay&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a65188cf299b16d1dbc05ceba51d2328a">delay</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>],</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                <span class="stringliteral">&quot;read_duration&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a4f29273c21baece6aabd20a46efdc0c8">duration</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>],</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                <span class="stringliteral">&quot;reporting_interval&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#ad632a70ea0d27ceefb51e2a8059a0dae">reporting_interval</a>,</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                <span class="stringliteral">&quot;requested_send_buffer_size&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a2b2a17fb2fce5fb908dad96b110cf17b">requested_send_buffer_size</a>,</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                <span class="stringliteral">&quot;requested_read_buffer_size&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a6f82584854b543c89a1cf9bd21c1ddc2">requested_read_buffer_size</a>,</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                <span class="stringliteral">&quot;maximum_block_size&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a89b7f00123725264aab18759d7bc7258">maximum_block_size</a>,</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                <span class="stringliteral">&quot;traffic_dump&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a3aee86084eac437051355cce738de2ef">traffic_dump</a>,</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                <span class="stringliteral">&quot;so_debug&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#ae1bb84bc89626d9c6950b41a7a124ee2">so_debug</a>,</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                <span class="stringliteral">&quot;route_record&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#aea33a5413dbace7b756f93afdea7963d">route_record</a>,</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                <span class="stringliteral">&quot;pushy&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#addf539178c60faab6c8fee7a54630fbc">pushy</a>,</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                <span class="stringliteral">&quot;shutdown&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a58ee2ce95a7ee3b8d2a06f3a55ccaf07">shutdown</a>,</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                <span class="stringliteral">&quot;write_rate&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#aacd8b6b923d36ebf4409798b62074320">write_rate</a>,</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                <span class="stringliteral">&quot;random_seed&quot;</span>,&amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#aa32e335e786e3b6634824fa757c285b9">random_seed</a>,</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                <span class="stringliteral">&quot;traffic_generation_request_distribution&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a51b97d90a014086a16cd9025179419d8">request_trafgen_options</a>.<a class="code" href="structtrafgen__options.html#a3d575b99d686962d4171c0dd7840cd6e">distribution</a>,</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                <span class="stringliteral">&quot;traffic_generation_request_param_one&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a51b97d90a014086a16cd9025179419d8">request_trafgen_options</a>.<a class="code" href="structtrafgen__options.html#aef412154fd2823aeb4765a8304d9849b">param_one</a>,</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                <span class="stringliteral">&quot;traffic_generation_request_param_two&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a51b97d90a014086a16cd9025179419d8">request_trafgen_options</a>.<a class="code" href="structtrafgen__options.html#ae8351c0c4aced5584b653530d5e7e723">param_two</a>,</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                <span class="stringliteral">&quot;traffic_generation_response_distribution&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a4094e6a3e73864f3e3f84a977d68a194">response_trafgen_options</a>.<a class="code" href="structtrafgen__options.html#a3d575b99d686962d4171c0dd7840cd6e">distribution</a>,</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                <span class="stringliteral">&quot;traffic_generation_response_param_one&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a4094e6a3e73864f3e3f84a977d68a194">response_trafgen_options</a>.<a class="code" href="structtrafgen__options.html#aef412154fd2823aeb4765a8304d9849b">param_one</a>,</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                <span class="stringliteral">&quot;traffic_generation_response_param_two&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a4094e6a3e73864f3e3f84a977d68a194">response_trafgen_options</a>.<a class="code" href="structtrafgen__options.html#ae8351c0c4aced5584b653530d5e7e723">param_two</a>,</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                <span class="stringliteral">&quot;traffic_generation_gap_distribution&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#ab0eca59327ee781cddb8fd170bc6d28e">interpacket_gap_trafgen_options</a>.<a class="code" href="structtrafgen__options.html#a3d575b99d686962d4171c0dd7840cd6e">distribution</a>,</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                <span class="stringliteral">&quot;traffic_generation_gap_param_one&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#ab0eca59327ee781cddb8fd170bc6d28e">interpacket_gap_trafgen_options</a>.<a class="code" href="structtrafgen__options.html#aef412154fd2823aeb4765a8304d9849b">param_one</a>,</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                <span class="stringliteral">&quot;traffic_generation_gap_param_two&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#ab0eca59327ee781cddb8fd170bc6d28e">interpacket_gap_trafgen_options</a>.<a class="code" href="structtrafgen__options.html#ae8351c0c4aced5584b653530d5e7e723">param_two</a>,</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                <span class="stringliteral">&quot;flow_control&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a9b37b291808623d607848c54c48f19f4">flow_control</a>,</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                <span class="stringliteral">&quot;byte_counting&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#abc6728769659e18a72dd12549d4f6f94">byte_counting</a>,</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                <span class="stringliteral">&quot;cork&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#ae229f5e5bd4c3689473dcb7b7debea6e">cork</a>,</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                <span class="stringliteral">&quot;nonagle&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#af1d11c3e1d43f04babc48c1c002a31ac">nonagle</a>,</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                <span class="stringliteral">&quot;cc_alg&quot;</span>, &amp;cc_alg,</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                <span class="stringliteral">&quot;elcn&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a773a21e329a31811844f9f26da458e62">elcn</a>,</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                <span class="stringliteral">&quot;lcd&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#aa16b93831301f5b6faf010158327cf67">lcd</a>,</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                <span class="stringliteral">&quot;mtcp&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#aeebdd152f5d7d68a4435b31313550bad">mtcp</a>,</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                <span class="stringliteral">&quot;dscp&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a06c29bb39cf7a6004178e5582949990a">dscp</a>,</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                <span class="stringliteral">&quot;ipmtudiscover&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a182d573decbb50a7691ab088dd630a54">ipmtudiscover</a>,</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                <span class="stringliteral">&quot;dump_prefix&quot;</span>, &amp;<a class="code" href="daemon_8h.html#a016095bb5b1fadba7bc57d2a0d1a75f8">dump_prefix</a>,</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                <span class="stringliteral">&quot;num_extra_socket_options&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a7e76c24f63b5771588d75e427d3df2cc">num_extra_socket_options</a>,</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                <span class="stringliteral">&quot;extra_socket_options&quot;</span>, &amp;extra_options);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keywordflow">if</span> (env-&gt;fault_occurred)</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="preprocessor">#ifndef HAVE_LIBPCAP</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a3aee86084eac437051355cce738de2ef">traffic_dump</a>)</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                XMLRPC_FAIL(env, XMLRPC_TYPE_ERROR, <span class="stringliteral">&quot;Daemon was asked to dump traffic, but wasn&#39;t compiled with libpcap support&quot;</span>);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="comment">/* Check for sanity */</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="keywordflow">if</span> (strlen(bind_address) &gt;= <span class="keyword">sizeof</span>(<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#afcde8c9da11b85204968beb70542dadb">bind_address</a>) - 1 ||</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                <a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a65188cf299b16d1dbc05ceba51d2328a">delay</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>] &lt; 0 || <a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a4f29273c21baece6aabd20a46efdc0c8">duration</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>] &lt; 0 ||</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                <a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a65188cf299b16d1dbc05ceba51d2328a">delay</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>] &lt; 0 || <a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a4f29273c21baece6aabd20a46efdc0c8">duration</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>] &lt; 0 ||</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                <a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a2b2a17fb2fce5fb908dad96b110cf17b">requested_send_buffer_size</a> &lt; 0 || <a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a6f82584854b543c89a1cf9bd21c1ddc2">requested_read_buffer_size</a> &lt; 0 ||</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                <a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a89b7f00123725264aab18759d7bc7258">maximum_block_size</a> &lt; <a class="code" href="common_8h.html#ac1f29ba54415975a2fa23e276fdf8a0f">MIN_BLOCK_SIZE</a> ||</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                <a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#aacd8b6b923d36ebf4409798b62074320">write_rate</a> &lt; 0 ||</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                strlen(cc_alg) &gt; <a class="code" href="common_8h.html#ae1a783b83d4ba2bb4aa31daeabe67a40">TCP_CA_NAME_MAX</a> ||</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                <a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a7e76c24f63b5771588d75e427d3df2cc">num_extra_socket_options</a> &lt; 0 || <a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a7e76c24f63b5771588d75e427d3df2cc">num_extra_socket_options</a> &gt; <a class="code" href="common_8h.html#a44290cfbe1b4727247d9fc624c6b5f74">MAX_EXTRA_SOCKET_OPTIONS</a> ||</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                xmlrpc_array_size(env, extra_options) != <a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a7e76c24f63b5771588d75e427d3df2cc">num_extra_socket_options</a>) {</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                XMLRPC_FAIL(env, XMLRPC_TYPE_ERROR, <span class="stringliteral">&quot;Flow settings incorrect&quot;</span>);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        }</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="comment">/* Parse extra socket options */</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a7e76c24f63b5771588d75e427d3df2cc">num_extra_socket_options</a>; i++) {</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* buffer = 0;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                <span class="keywordtype">size_t</span> len;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                xmlrpc_value *option, *level = 0, *optname = 0, *value = 0;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                xmlrpc_array_read_item(env, extra_options, i, &amp;option);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                <span class="keywordflow">if</span> (!env-&gt;fault_occurred)</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                        xmlrpc_struct_read_value(env, option, <span class="stringliteral">&quot;level&quot;</span>, &amp;level);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                <span class="keywordflow">if</span> (!env-&gt;fault_occurred)</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                        xmlrpc_struct_read_value(env, option, <span class="stringliteral">&quot;optname&quot;</span>, &amp;optname);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                <span class="keywordflow">if</span> (!env-&gt;fault_occurred)</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                        xmlrpc_struct_read_value(env, option, <span class="stringliteral">&quot;value&quot;</span>, &amp;value);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                <span class="keywordflow">if</span> (!env-&gt;fault_occurred)</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                        xmlrpc_read_int(env, level, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a22210a3991fe95e08e4b43e1840b0394">extra_socket_options</a>[i].<a class="code" href="structflow__settings_1_1extra__socket__options.html#ab4c9283e6c6989000ce3fbb1c10edb21">level</a>);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                <span class="keywordflow">if</span> (!env-&gt;fault_occurred)</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                        xmlrpc_read_int(env, optname, &amp;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a22210a3991fe95e08e4b43e1840b0394">extra_socket_options</a>[i].<a class="code" href="structflow__settings_1_1extra__socket__options.html#a1fb402cd50480d5ee99cc0e7632d4e68">optname</a>);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                <span class="keywordflow">if</span> (!env-&gt;fault_occurred)</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                        xmlrpc_read_base64(env, value, &amp;len, &amp;buffer);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                <span class="keywordflow">if</span> (level)</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                        xmlrpc_DECREF(level);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                <span class="keywordflow">if</span> (optname)</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                        xmlrpc_DECREF(optname);</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                <span class="keywordflow">if</span> (value)</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                        xmlrpc_DECREF(value);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                <span class="keywordflow">if</span> (!env-&gt;fault_occurred) {</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                        <span class="keywordflow">if</span> (len &gt; <a class="code" href="common_8h.html#a22d5973f37c892d2137175ec2fee19d5">MAX_EXTRA_SOCKET_OPTION_VALUE_LENGTH</a>) {</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                                free((<span class="keywordtype">void</span> *)buffer);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                                XMLRPC_FAIL(env, XMLRPC_TYPE_ERROR, <span class="stringliteral">&quot;Too long extra socket option length&quot;</span>);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                        }</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                        <a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a22210a3991fe95e08e4b43e1840b0394">extra_socket_options</a>[i].<a class="code" href="structflow__settings_1_1extra__socket__options.html#acc49adee57829cf50c4bf87f80ecf9a0">optlen</a> = len;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                        memcpy(<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a22210a3991fe95e08e4b43e1840b0394">extra_socket_options</a>[i].<a class="code" href="structflow__settings_1_1extra__socket__options.html#a8e75e02f1762c213c74ee92ead514312">optval</a>, buffer, len);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                        free((<span class="keywordtype">void</span> *)buffer);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                <span class="keywordflow">if</span> (env-&gt;fault_occurred)</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                        <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        }</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        strcpy(<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#a1206d0f66388f1f916f1ea237453a8db">cc_alg</a>, cc_alg);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        strcpy(<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>.<a class="code" href="structflow__settings.html#afcde8c9da11b85204968beb70542dadb">bind_address</a>, bind_address);</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_WARNING, <span class="stringliteral">&quot;bind_address=%s&quot;</span>, bind_address);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        request = malloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrequest__add__flow__destination.html">request_add_flow_destination</a>));</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        request-&gt;<a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a> = <a class="code" href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">settings</a>;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        rc = <a class="code" href="daemon_8c.html#a4271388fd018c3d910e4839b3747df96">dispatch_request</a>((<span class="keyword">struct</span> request*)request, <a class="code" href="daemon_8h.html#a1cb3dd3b58581d382be8492aba04511f">REQUEST_ADD_DESTINATION</a>);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="keywordflow">if</span> (rc == -1)</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                XMLRPC_FAIL(env, XMLRPC_INTERNAL_ERROR, request-&gt;<a class="code" href="structrequest__add__flow__destination.html#aa28848db1213a981170a9952f1fb038b">r</a>.<a class="code" href="structrequest.html#acc214191f4fbfabdedf789adc862b393">error</a>); <span class="comment">/* goto cleanup on failure */</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="comment">/* Return our result. */</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        ret = xmlrpc_build_value(env, <span class="stringliteral">&quot;{s:i,s:i,s:i,s:i}&quot;</span>,</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                <span class="stringliteral">&quot;flow_id&quot;</span>, request-&gt;<a class="code" href="structrequest__add__flow__destination.html#aa00e3a2d86bf6b7837c1c366fa384c7e">flow_id</a>,</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                <span class="stringliteral">&quot;listen_data_port&quot;</span>, request-&gt;<a class="code" href="structrequest__add__flow__destination.html#a2ce44e2c61c54f76f0cbc79173d14373">listen_data_port</a>,</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                <span class="stringliteral">&quot;real_listen_send_buffer_size&quot;</span>, request-&gt;<a class="code" href="structrequest__add__flow__destination.html#a347e84bf5ce7d91287e411ce1ed80f0e">real_listen_send_buffer_size</a>,</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                <span class="stringliteral">&quot;real_listen_read_buffer_size&quot;</span>, request-&gt;<a class="code" href="structrequest__add__flow__destination.html#a329f8adb8186e997f263b2dce771d6a0">real_listen_read_buffer_size</a>);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;cleanup:</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="keywordflow">if</span> (request)</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                <a class="code" href="fg__definitions_8h.html#a9735559a214ac1d8d9f8ceddfaeca672">free_all</a>(request-&gt;<a class="code" href="structrequest__add__flow__destination.html#aa28848db1213a981170a9952f1fb038b">r</a>.<a class="code" href="structrequest.html#acc214191f4fbfabdedf789adc862b393">error</a>, request);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <a class="code" href="fg__definitions_8h.html#a9735559a214ac1d8d9f8ceddfaeca672">free_all</a>(cc_alg, bind_address);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keywordflow">if</span> (extra_options)</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                xmlrpc_DECREF(extra_options);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="keywordflow">if</span> (env-&gt;fault_occurred)</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                <a class="code" href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a>(LOG_WARNING, <span class="stringliteral">&quot;method add_flow_destination failed: %s&quot;</span>,</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                        env-&gt;fault_string);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_WARNING, <span class="stringliteral">&quot;method add_flow_destination successful&quot;</span>);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;}</div><div class="ttc" id="structflow__settings_html_a89b7f00123725264aab18759d7bc7258"><div class="ttname"><a href="structflow__settings.html#a89b7f00123725264aab18759d7bc7258">flow_settings::maximum_block_size</a></div><div class="ttdeci">int maximum_block_size</div><div class="ttdoc">Application buffer size in bytes (option -U). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00201">common.h:201</a></div></div>
<div class="ttc" id="structflow__settings_html_aeebdd152f5d7d68a4435b31313550bad"><div class="ttname"><a href="structflow__settings.html#aeebdd152f5d7d68a4435b31313550bad">flow_settings::mtcp</a></div><div class="ttdeci">int mtcp</div><div class="ttdoc">Set TCP_MTCP (15) on test socket (option -O). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00242">common.h:242</a></div></div>
<div class="ttc" id="structflow__settings_html_a7e76c24f63b5771588d75e427d3df2cc"><div class="ttname"><a href="structflow__settings.html#a7e76c24f63b5771588d75e427d3df2cc">flow_settings::num_extra_socket_options</a></div><div class="ttdeci">int num_extra_socket_options</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00262">common.h:262</a></div></div>
<div class="ttc" id="structflow__settings_html_aa16b93831301f5b6faf010158327cf67"><div class="ttname"><a href="structflow__settings.html#aa16b93831301f5b6faf010158327cf67">flow_settings::lcd</a></div><div class="ttdeci">int lcd</div><div class="ttdoc">Set TCP_LCD (21) on test socket (option -O). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00240">common.h:240</a></div></div>
<div class="ttc" id="common_8h_html_a44290cfbe1b4727247d9fc624c6b5f74"><div class="ttname"><a href="common_8h.html#a44290cfbe1b4727247d9fc624c6b5f74">MAX_EXTRA_SOCKET_OPTIONS</a></div><div class="ttdeci">#define MAX_EXTRA_SOCKET_OPTIONS</div><div class="ttdoc">Max number of arbitrary extra socket options which may sent to the deamon. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00068">common.h:68</a></div></div>
<div class="ttc" id="daemon_8h_html_a016095bb5b1fadba7bc57d2a0d1a75f8"><div class="ttname"><a href="daemon_8h.html#a016095bb5b1fadba7bc57d2a0d1a75f8">dump_prefix</a></div><div class="ttdeci">char * dump_prefix</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00272">daemon.h:272</a></div></div>
<div class="ttc" id="structflow__settings_html_a2b2a17fb2fce5fb908dad96b110cf17b"><div class="ttname"><a href="structflow__settings.html#a2b2a17fb2fce5fb908dad96b110cf17b">flow_settings::requested_send_buffer_size</a></div><div class="ttdeci">int requested_send_buffer_size</div><div class="ttdoc">Request sender buffer in bytes (option -B). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00196">common.h:196</a></div></div>
<div class="ttc" id="fg__log_8c_html_a2aea54bb4eab90a69510db34326d82f4"><div class="ttname"><a href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a></div><div class="ttdeci">void logging(int priority, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="fg__log_8c_source.html#l00069">fg_log.c:69</a></div></div>
<div class="ttc" id="common_8h_html_a22d5973f37c892d2137175ec2fee19d5"><div class="ttname"><a href="common_8h.html#a22d5973f37c892d2137175ec2fee19d5">MAX_EXTRA_SOCKET_OPTION_VALUE_LENGTH</a></div><div class="ttdeci">#define MAX_EXTRA_SOCKET_OPTION_VALUE_LENGTH</div><div class="ttdoc">Ensures extra options are limited in length on both controller and deamon. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00071">common.h:71</a></div></div>
<div class="ttc" id="structflow__settings_html_aacd8b6b923d36ebf4409798b62074320"><div class="ttname"><a href="structflow__settings.html#aacd8b6b923d36ebf4409798b62074320">flow_settings::write_rate</a></div><div class="ttdeci">int write_rate</div><div class="ttdoc">The actual rate we should send. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00220">common.h:220</a></div></div>
<div class="ttc" id="common_8h_html_ae1a783b83d4ba2bb4aa31daeabe67a40"><div class="ttname"><a href="common_8h.html#ae1a783b83d4ba2bb4aa31daeabe67a40">TCP_CA_NAME_MAX</a></div><div class="ttdeci">#define TCP_CA_NAME_MAX</div><div class="ttdoc">Max size of the congestion control algorithm specifier string. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00075">common.h:75</a></div></div>
<div class="ttc" id="structflow__settings_html_a65188cf299b16d1dbc05ceba51d2328a"><div class="ttname"><a href="structflow__settings.html#a65188cf299b16d1dbc05ceba51d2328a">flow_settings::delay</a></div><div class="ttdeci">double delay[2]</div><div class="ttdoc">Delay of flow in seconds (option -Y). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00188">common.h:188</a></div></div>
<div class="ttc" id="daemon_8c_html_a4271388fd018c3d910e4839b3747df96"><div class="ttname"><a href="daemon_8c.html#a4271388fd018c3d910e4839b3747df96">dispatch_request</a></div><div class="ttdeci">int dispatch_request(struct request *request, int type)</div><div class="ttdoc">Dispatch a request to daemon loop. </div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l01485">daemon.c:1485</a></div></div>
<div class="ttc" id="structflow__settings_1_1extra__socket__options_html_acc49adee57829cf50c4bf87f80ecf9a0"><div class="ttname"><a href="structflow__settings_1_1extra__socket__options.html#acc49adee57829cf50c4bf87f80ecf9a0">flow_settings::extra_socket_options::optlen</a></div><div class="ttdeci">int optlen</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00259">common.h:259</a></div></div>
<div class="ttc" id="structrequest__add__flow__destination_html_a329f8adb8186e997f263b2dce771d6a0"><div class="ttname"><a href="structrequest__add__flow__destination.html#a329f8adb8186e997f263b2dce771d6a0">request_add_flow_destination::real_listen_read_buffer_size</a></div><div class="ttdeci">int real_listen_read_buffer_size</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00203">daemon.h:203</a></div></div>
<div class="ttc" id="structflow__settings_1_1extra__socket__options_html_a8e75e02f1762c213c74ee92ead514312"><div class="ttname"><a href="structflow__settings_1_1extra__socket__options.html#a8e75e02f1762c213c74ee92ead514312">flow_settings::extra_socket_options::optval</a></div><div class="ttdeci">char optval[MAX_EXTRA_SOCKET_OPTION_VALUE_LENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00260">common.h:260</a></div></div>
<div class="ttc" id="structflow__settings_html_ae229f5e5bd4c3689473dcb7b7debea6e"><div class="ttname"><a href="structflow__settings.html#ae229f5e5bd4c3689473dcb7b7debea6e">flow_settings::cork</a></div><div class="ttdeci">int cork</div><div class="ttdoc">Sets SO_DEBUG on test socket (option -O). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00232">common.h:232</a></div></div>
<div class="ttc" id="structtrafgen__options_html_ae8351c0c4aced5584b653530d5e7e723"><div class="ttname"><a href="structtrafgen__options.html#ae8351c0c4aced5584b653530d5e7e723">trafgen_options::param_two</a></div><div class="ttdeci">double param_two</div><div class="ttdoc">Second mathematical parameter of the distribution, if required. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00172">common.h:172</a></div></div>
<div class="ttc" id="debug_8h_html_ae420d5a1d63f99c6a2a386c4eea54250"><div class="ttname"><a href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a></div><div class="ttdeci">#define DEBUG_MSG(LVL, MSG,...)</div><div class="ttdoc">Print debug message to standard error. </div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00049">debug.h:49</a></div></div>
<div class="ttc" id="structflow__settings_html_a1206d0f66388f1f916f1ea237453a8db"><div class="ttname"><a href="structflow__settings.html#a1206d0f66388f1f916f1ea237453a8db">flow_settings::cc_alg</a></div><div class="ttdeci">char cc_alg[TCP_CA_NAME_MAX]</div><div class="ttdoc">Set congestion control algorithm ALG on test socket (option -O). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00236">common.h:236</a></div></div>
<div class="ttc" id="structrequest__add__flow__destination_html_a2ce44e2c61c54f76f0cbc79173d14373"><div class="ttname"><a href="structrequest__add__flow__destination.html#a2ce44e2c61c54f76f0cbc79173d14373">request_add_flow_destination::listen_data_port</a></div><div class="ttdeci">int listen_data_port</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00201">daemon.h:201</a></div></div>
<div class="ttc" id="structflow__settings_html_a182d573decbb50a7691ab088dd630a54"><div class="ttname"><a href="structflow__settings.html#a182d573decbb50a7691ab088dd630a54">flow_settings::ipmtudiscover</a></div><div class="ttdeci">int ipmtudiscover</div><div class="ttdoc">Set IP_MTU_DISCOVER on test socket (option -O). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00246">common.h:246</a></div></div>
<div class="ttc" id="structrequest__add__flow__destination_html_a347e84bf5ce7d91287e411ce1ed80f0e"><div class="ttname"><a href="structrequest__add__flow__destination.html#a347e84bf5ce7d91287e411ce1ed80f0e">request_add_flow_destination::real_listen_send_buffer_size</a></div><div class="ttdeci">int real_listen_send_buffer_size</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00202">daemon.h:202</a></div></div>
<div class="ttc" id="structflow__settings_html_addf539178c60faab6c8fee7a54630fbc"><div class="ttname"><a href="structflow__settings.html#addf539178c60faab6c8fee7a54630fbc">flow_settings::pushy</a></div><div class="ttdeci">int pushy</div><div class="ttdoc">Do not iterate through select() to continue sending in case block size did not suffice to fill sendin...</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00213">common.h:213</a></div></div>
<div class="ttc" id="structrequest_html_acc214191f4fbfabdedf789adc862b393"><div class="ttname"><a href="structrequest.html#acc214191f4fbfabdedf789adc862b393">request::error</a></div><div class="ttdeci">char * error</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00187">daemon.h:187</a></div></div>
<div class="ttc" id="common_8h_html_ac1f29ba54415975a2fa23e276fdf8a0f"><div class="ttname"><a href="common_8h.html#ac1f29ba54415975a2fa23e276fdf8a0f">MIN_BLOCK_SIZE</a></div><div class="ttdeci">#define MIN_BLOCK_SIZE</div><div class="ttdoc">Minium block (message) size we can send. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00079">common.h:79</a></div></div>
<div class="ttc" id="fg__definitions_8h_html_a239dd5192fcd165ce89d2c6d08e34993"><div class="ttname"><a href="fg__definitions_8h.html#a239dd5192fcd165ce89d2c6d08e34993">UNUSED_ARGUMENT</a></div><div class="ttdeci">#define UNUSED_ARGUMENT(x)</div><div class="ttdoc">Suppress warning for unused argument. </div><div class="ttdef"><b>Definition:</b> <a href="fg__definitions_8h_source.html#l00038">fg_definitions.h:38</a></div></div>
<div class="ttc" id="structflow__settings_html_a06c29bb39cf7a6004178e5582949990a"><div class="ttname"><a href="structflow__settings.html#a06c29bb39cf7a6004178e5582949990a">flow_settings::dscp</a></div><div class="ttdeci">int dscp</div><div class="ttdoc">DSCP value for TOS byte (option -D). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00244">common.h:244</a></div></div>
<div class="ttc" id="structflow__settings_html_a6f82584854b543c89a1cf9bd21c1ddc2"><div class="ttname"><a href="structflow__settings.html#a6f82584854b543c89a1cf9bd21c1ddc2">flow_settings::requested_read_buffer_size</a></div><div class="ttdeci">int requested_read_buffer_size</div><div class="ttdoc">Request receiver buffer, advertised window in bytes (option -W). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00198">common.h:198</a></div></div>
<div class="ttc" id="structflow__settings_html_aea33a5413dbace7b756f93afdea7963d"><div class="ttname"><a href="structflow__settings.html#aea33a5413dbace7b756f93afdea7963d">flow_settings::route_record</a></div><div class="ttdeci">int route_record</div><div class="ttdoc">Sets ROUTE_RECORD on test socket (option -O). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00208">common.h:208</a></div></div>
<div class="ttc" id="structflow__settings_html_a22210a3991fe95e08e4b43e1840b0394"><div class="ttname"><a href="structflow__settings.html#a22210a3991fe95e08e4b43e1840b0394">flow_settings::extra_socket_options</a></div><div class="ttdeci">struct flow_settings::extra_socket_options extra_socket_options[MAX_EXTRA_SOCKET_OPTIONS]</div></div>
<div class="ttc" id="fg__definitions_8h_html_a9735559a214ac1d8d9f8ceddfaeca672"><div class="ttname"><a href="fg__definitions_8h.html#a9735559a214ac1d8d9f8ceddfaeca672">free_all</a></div><div class="ttdeci">#define free_all(...)</div><div class="ttdoc">To free() an arbitrary number of variables. </div><div class="ttdef"><b>Definition:</b> <a href="fg__definitions_8h_source.html#l00059">fg_definitions.h:59</a></div></div>
<div class="ttc" id="structflow__settings_html_aa32e335e786e3b6634824fa757c285b9"><div class="ttname"><a href="structflow__settings.html#aa32e335e786e3b6634824fa757c285b9">flow_settings::random_seed</a></div><div class="ttdeci">unsigned random_seed</div><div class="ttdoc">Random seed to use (default: read /dev/urandom) (option -J). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00223">common.h:223</a></div></div>
<div class="ttc" id="structflow__settings_html_a4094e6a3e73864f3e3f84a977d68a194"><div class="ttname"><a href="structflow__settings.html#a4094e6a3e73864f3e3f84a977d68a194">flow_settings::response_trafgen_options</a></div><div class="ttdeci">struct trafgen_options response_trafgen_options</div><div class="ttdoc">Stochastic traffic generation settings for the response size. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00251">common.h:251</a></div></div>
<div class="ttc" id="daemon_8h_html_a1cb3dd3b58581d382be8492aba04511f"><div class="ttname"><a href="daemon_8h.html#a1cb3dd3b58581d382be8492aba04511f">REQUEST_ADD_DESTINATION</a></div><div class="ttdeci">#define REQUEST_ADD_DESTINATION</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00173">daemon.h:173</a></div></div>
<div class="ttc" id="structflow__settings_html_ab0eca59327ee781cddb8fd170bc6d28e"><div class="ttname"><a href="structflow__settings.html#ab0eca59327ee781cddb8fd170bc6d28e">flow_settings::interpacket_gap_trafgen_options</a></div><div class="ttdeci">struct trafgen_options interpacket_gap_trafgen_options</div><div class="ttdoc">Stochastic traffic generation settings for the interpacket gap. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00253">common.h:253</a></div></div>
<div class="ttc" id="structflow__settings_html_a773a21e329a31811844f9f26da458e62"><div class="ttname"><a href="structflow__settings.html#a773a21e329a31811844f9f26da458e62">flow_settings::elcn</a></div><div class="ttdeci">int elcn</div><div class="ttdoc">Set TCP_ELCN (20) on test socket (option -O). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00238">common.h:238</a></div></div>
<div class="ttc" id="structrequest__add__flow__destination_html_aa00e3a2d86bf6b7837c1c366fa384c7e"><div class="ttname"><a href="structrequest__add__flow__destination.html#aa00e3a2d86bf6b7837c1c366fa384c7e">request_add_flow_destination::flow_id</a></div><div class="ttdeci">int flow_id</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00200">daemon.h:200</a></div></div>
<div class="ttc" id="structflow__settings_html_a3aee86084eac437051355cce738de2ef"><div class="ttname"><a href="structflow__settings.html#a3aee86084eac437051355cce738de2ef">flow_settings::traffic_dump</a></div><div class="ttdeci">int traffic_dump</div><div class="ttdoc">Dump traffic using libpcap (option -M). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00204">common.h:204</a></div></div>
<div class="ttc" id="common_8h_html_a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6"><div class="ttname"><a href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a></div><div class="ttdoc">Read operation. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00108">common.h:108</a></div></div>
<div class="ttc" id="structrequest__add__flow__destination_html_aa28848db1213a981170a9952f1fb038b"><div class="ttname"><a href="structrequest__add__flow__destination.html#aa28848db1213a981170a9952f1fb038b">request_add_flow_destination::r</a></div><div class="ttdeci">struct request r</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00195">daemon.h:195</a></div></div>
<div class="ttc" id="structflow__settings_html_ae1bb84bc89626d9c6950b41a7a124ee2"><div class="ttname"><a href="structflow__settings.html#ae1bb84bc89626d9c6950b41a7a124ee2">flow_settings::so_debug</a></div><div class="ttdeci">int so_debug</div><div class="ttdoc">Sets SO_DEBUG on test socket (option -O). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00206">common.h:206</a></div></div>
<div class="ttc" id="common_8h_html_a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc"><div class="ttname"><a href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a></div><div class="ttdoc">Write operation. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00106">common.h:106</a></div></div>
<div class="ttc" id="structrequest_html"><div class="ttname"><a href="structrequest.html">request</a></div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00179">daemon.h:179</a></div></div>
<div class="ttc" id="structflow__settings_html_a4f29273c21baece6aabd20a46efdc0c8"><div class="ttname"><a href="structflow__settings.html#a4f29273c21baece6aabd20a46efdc0c8">flow_settings::duration</a></div><div class="ttdeci">double duration[2]</div><div class="ttdoc">Duration of flow in seconds (option -T). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00190">common.h:190</a></div></div>
<div class="ttc" id="structflow__settings_html_a1144784676f7ead2cf557fa96838ddb2"><div class="ttname"><a href="structflow__settings.html#a1144784676f7ead2cf557fa96838ddb2">flow_settings::flow_id</a></div><div class="ttdeci">int flow_id</div><div class="ttdoc">Flow ID maintained by controller. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00186">common.h:186</a></div></div>
<div class="ttc" id="structflow__settings_html_a9b37b291808623d607848c54c48f19f4"><div class="ttname"><a href="structflow__settings.html#a9b37b291808623d607848c54c48f19f4">flow_settings::flow_control</a></div><div class="ttdeci">int flow_control</div><div class="ttdoc">Stop flow if it is experiencing local congestion (option -C). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00226">common.h:226</a></div></div>
<div class="ttc" id="structflow__settings_html_abc6728769659e18a72dd12549d4f6f94"><div class="ttname"><a href="structflow__settings.html#abc6728769659e18a72dd12549d4f6f94">flow_settings::byte_counting</a></div><div class="ttdeci">int byte_counting</div><div class="ttdoc">Enumerate bytes in payload instead of sending zeros (option -E). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00229">common.h:229</a></div></div>
<div class="ttc" id="structtrafgen__options_html_aef412154fd2823aeb4765a8304d9849b"><div class="ttname"><a href="structtrafgen__options.html#aef412154fd2823aeb4765a8304d9849b">trafgen_options::param_one</a></div><div class="ttdeci">double param_one</div><div class="ttdoc">First mathemathical parameter of the distribution. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00170">common.h:170</a></div></div>
<div class="ttc" id="structflow__settings_1_1extra__socket__options_html_ab4c9283e6c6989000ce3fbb1c10edb21"><div class="ttname"><a href="structflow__settings_1_1extra__socket__options.html#ab4c9283e6c6989000ce3fbb1c10edb21">flow_settings::extra_socket_options::level</a></div><div class="ttdeci">int level</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00257">common.h:257</a></div></div>
<div class="ttc" id="structrequest__add__flow__destination_html"><div class="ttname"><a href="structrequest__add__flow__destination.html">request_add_flow_destination</a></div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00193">daemon.h:193</a></div></div>
<div class="ttc" id="structtrafgen__options_html_a3d575b99d686962d4171c0dd7840cd6e"><div class="ttname"><a href="structtrafgen__options.html#a3d575b99d686962d4171c0dd7840cd6e">trafgen_options::distribution</a></div><div class="ttdeci">enum distribution_t distribution</div><div class="ttdoc">The stochastic distribution to draw values from. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00168">common.h:168</a></div></div>
<div class="ttc" id="structflow__settings_1_1extra__socket__options_html_a1fb402cd50480d5ee99cc0e7632d4e68"><div class="ttname"><a href="structflow__settings_1_1extra__socket__options.html#a1fb402cd50480d5ee99cc0e7632d4e68">flow_settings::extra_socket_options::optname</a></div><div class="ttdeci">int optname</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00258">common.h:258</a></div></div>
<div class="ttc" id="structflow__settings_html_afcde8c9da11b85204968beb70542dadb"><div class="ttname"><a href="structflow__settings.html#afcde8c9da11b85204968beb70542dadb">flow_settings::bind_address</a></div><div class="ttdeci">char bind_address[1000]</div><div class="ttdoc">The interface address for the flow (used by daemon). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00183">common.h:183</a></div></div>
<div class="ttc" id="structflow__settings_html_af1d11c3e1d43f04babc48c1c002a31ac"><div class="ttname"><a href="structflow__settings.html#af1d11c3e1d43f04babc48c1c002a31ac">flow_settings::nonagle</a></div><div class="ttdeci">int nonagle</div><div class="ttdoc">Disable nagle algorithm on test socket (option -O). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00234">common.h:234</a></div></div>
<div class="ttc" id="structflow__settings_html_a58ee2ce95a7ee3b8d2a06f3a55ccaf07"><div class="ttname"><a href="structflow__settings.html#a58ee2ce95a7ee3b8d2a06f3a55ccaf07">flow_settings::shutdown</a></div><div class="ttdeci">int shutdown</div><div class="ttdoc">Shutdown socket after test flow (option -N). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00215">common.h:215</a></div></div>
<div class="ttc" id="structrequest__add__flow__destination_html_a1fe3d03ba9343f30b69acb45912dbccb"><div class="ttname"><a href="structrequest__add__flow__destination.html#a1fe3d03ba9343f30b69acb45912dbccb">request_add_flow_destination::settings</a></div><div class="ttdeci">struct flow_settings settings</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00197">daemon.h:197</a></div></div>
<div class="ttc" id="structflow__settings_html"><div class="ttname"><a href="structflow__settings.html">flow_settings</a></div><div class="ttdoc">Settings that describe a flow between from a endpoint&amp;#39;s perspective. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00181">common.h:181</a></div></div>
<div class="ttc" id="structflow__settings_html_a51b97d90a014086a16cd9025179419d8"><div class="ttname"><a href="structflow__settings.html#a51b97d90a014086a16cd9025179419d8">flow_settings::request_trafgen_options</a></div><div class="ttdeci">struct trafgen_options request_trafgen_options</div><div class="ttdoc">Stochastic traffic generation settings for the request size. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00249">common.h:249</a></div></div>
<div class="ttc" id="structflow__settings_html_ad632a70ea0d27ceefb51e2a8059a0dae"><div class="ttname"><a href="structflow__settings.html#ad632a70ea0d27ceefb51e2a8059a0dae">flow_settings::reporting_interval</a></div><div class="ttdeci">double reporting_interval</div><div class="ttdoc">Interval to report flow on screen (option -i). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00193">common.h:193</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a55fd54a0087dd0ac821433cbda1f65bd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static xmlrpc_value* add_flow_source </td>
          <td>(</td>
          <td class="paramtype">xmlrpc_env *const&#160;</td>
          <td class="paramname"><em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">xmlrpc_value *const&#160;</td>
          <td class="paramname"><em>param_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *const&#160;</td>
          <td class="paramname"><em>user_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prepare data connection for source endpoint. </p>
<p>Flowgrind rpc server decode the information from the controller XML-RPC and construct the request data structure to add flow in the source daemon. The request is dispatched to source daemon. The source daemon execute the request and send back the executed result in the request reply to the flowgrind rpc server. Flowgrind rpc server then encode the request reply information from the daemon and send back the data to the flowgrind controller through XML-RPC connection</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">env</td><td>XML-RPC environment object </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">param_array</td><td>XML-RPC value </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user_data</td><td>unused arg return xmlrpc_value XML-RPC value </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="fg__rpc__server_8c_source.html#l00062">62</a> of file <a class="el" href="fg__rpc__server_8c_source.html">fg_rpc_server.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;{</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <a class="code" href="fg__definitions_8h.html#a239dd5192fcd165ce89d2c6d08e34993">UNUSED_ARGUMENT</a>(user_data);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordtype">int</span> rc, i;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        xmlrpc_value *ret = 0;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordtype">char</span>* destination_host = 0;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordtype">char</span>* cc_alg = 0;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordtype">char</span>* bind_address = 0;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        xmlrpc_value* extra_options = 0;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keyword">struct </span><a class="code" href="structflow__settings.html">flow_settings</a> settings;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keyword">struct </span><a class="code" href="structflow__source__settings.html">flow_source_settings</a> source_settings;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keyword">struct </span><a class="code" href="structrequest__add__flow__source.html">request_add_flow_source</a>* <a class="code" href="structrequest.html">request</a> = 0;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_WARNING, <span class="stringliteral">&quot;method add_flow_source called&quot;</span>);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="comment">/* Parse our argument array. */</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        xmlrpc_decompose_value(env, param_array,</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                <span class="stringliteral">&quot;(&quot;</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                <span class="stringliteral">&quot;{s:s,*}&quot;</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                <span class="stringliteral">&quot;{s:i,*}&quot;</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                <span class="stringliteral">&quot;{s:d,s:d,s:d,s:d,s:d,*}&quot;</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                <span class="stringliteral">&quot;{s:i,s:i,*}&quot;</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                <span class="stringliteral">&quot;{s:i,*}&quot;</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                <span class="stringliteral">&quot;{s:b,s:b,s:b,s:b,s:b,*}&quot;</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                <span class="stringliteral">&quot;{s:i,s:i,*}&quot;</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                <span class="stringliteral">&quot;{s:i,s:d,s:d,*}&quot;</span> <span class="comment">/* request */</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                <span class="stringliteral">&quot;{s:i,s:d,s:d,*}&quot;</span> <span class="comment">/* response */</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                <span class="stringliteral">&quot;{s:i,s:d,s:d,*}&quot;</span> <span class="comment">/* interpacket_gap */</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                <span class="stringliteral">&quot;{s:b,s:b,s:i,s:i,*}&quot;</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                <span class="stringliteral">&quot;{s:s,*}&quot;</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                <span class="stringliteral">&quot;{s:i,s:i,s:i,s:i,s:i,*}&quot;</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                <span class="stringliteral">&quot;{s:s,*}&quot;</span> <span class="comment">/* for LIBPCAP dumps */</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                <span class="stringliteral">&quot;{s:i,s:A,*}&quot;</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                <span class="stringliteral">&quot;{s:s,s:i,s:i,*}&quot;</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                <span class="stringliteral">&quot;)&quot;</span>,</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                <span class="comment">/* general settings */</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                <span class="stringliteral">&quot;bind_address&quot;</span>, &amp;bind_address,</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                <span class="stringliteral">&quot;flow_id&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a1144784676f7ead2cf557fa96838ddb2">flow_id</a>,</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                <span class="stringliteral">&quot;write_delay&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a65188cf299b16d1dbc05ceba51d2328a">delay</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>],</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                <span class="stringliteral">&quot;write_duration&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a4f29273c21baece6aabd20a46efdc0c8">duration</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>],</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                <span class="stringliteral">&quot;read_delay&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a65188cf299b16d1dbc05ceba51d2328a">delay</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>],</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                <span class="stringliteral">&quot;read_duration&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a4f29273c21baece6aabd20a46efdc0c8">duration</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>],</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                <span class="stringliteral">&quot;reporting_interval&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#ad632a70ea0d27ceefb51e2a8059a0dae">reporting_interval</a>,</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                <span class="stringliteral">&quot;requested_send_buffer_size&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a2b2a17fb2fce5fb908dad96b110cf17b">requested_send_buffer_size</a>,</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                <span class="stringliteral">&quot;requested_read_buffer_size&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a6f82584854b543c89a1cf9bd21c1ddc2">requested_read_buffer_size</a>,</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                <span class="stringliteral">&quot;maximum_block_size&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a89b7f00123725264aab18759d7bc7258">maximum_block_size</a>,</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                <span class="stringliteral">&quot;traffic_dump&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a3aee86084eac437051355cce738de2ef">traffic_dump</a>,</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                <span class="stringliteral">&quot;so_debug&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#ae1bb84bc89626d9c6950b41a7a124ee2">so_debug</a>,</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                <span class="stringliteral">&quot;route_record&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#aea33a5413dbace7b756f93afdea7963d">route_record</a>,</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                <span class="stringliteral">&quot;pushy&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#addf539178c60faab6c8fee7a54630fbc">pushy</a>,</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                <span class="stringliteral">&quot;shutdown&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a58ee2ce95a7ee3b8d2a06f3a55ccaf07">shutdown</a>,</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                <span class="stringliteral">&quot;write_rate&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#aacd8b6b923d36ebf4409798b62074320">write_rate</a>,</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                <span class="stringliteral">&quot;random_seed&quot;</span>,&amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#aa32e335e786e3b6634824fa757c285b9">random_seed</a>,</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                <span class="stringliteral">&quot;traffic_generation_request_distribution&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a51b97d90a014086a16cd9025179419d8">request_trafgen_options</a>.<a class="code" href="structtrafgen__options.html#a3d575b99d686962d4171c0dd7840cd6e">distribution</a>,</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                <span class="stringliteral">&quot;traffic_generation_request_param_one&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a51b97d90a014086a16cd9025179419d8">request_trafgen_options</a>.<a class="code" href="structtrafgen__options.html#aef412154fd2823aeb4765a8304d9849b">param_one</a>,</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                <span class="stringliteral">&quot;traffic_generation_request_param_two&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a51b97d90a014086a16cd9025179419d8">request_trafgen_options</a>.<a class="code" href="structtrafgen__options.html#ae8351c0c4aced5584b653530d5e7e723">param_two</a>,</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                <span class="stringliteral">&quot;traffic_generation_response_distribution&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a4094e6a3e73864f3e3f84a977d68a194">response_trafgen_options</a>.<a class="code" href="structtrafgen__options.html#a3d575b99d686962d4171c0dd7840cd6e">distribution</a>,</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                <span class="stringliteral">&quot;traffic_generation_response_param_one&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a4094e6a3e73864f3e3f84a977d68a194">response_trafgen_options</a>.<a class="code" href="structtrafgen__options.html#aef412154fd2823aeb4765a8304d9849b">param_one</a>,</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                <span class="stringliteral">&quot;traffic_generation_response_param_two&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a4094e6a3e73864f3e3f84a977d68a194">response_trafgen_options</a>.<a class="code" href="structtrafgen__options.html#ae8351c0c4aced5584b653530d5e7e723">param_two</a>,</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                <span class="stringliteral">&quot;traffic_generation_gap_distribution&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#ab0eca59327ee781cddb8fd170bc6d28e">interpacket_gap_trafgen_options</a>.<a class="code" href="structtrafgen__options.html#a3d575b99d686962d4171c0dd7840cd6e">distribution</a>,</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                <span class="stringliteral">&quot;traffic_generation_gap_param_one&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#ab0eca59327ee781cddb8fd170bc6d28e">interpacket_gap_trafgen_options</a>.<a class="code" href="structtrafgen__options.html#aef412154fd2823aeb4765a8304d9849b">param_one</a>,</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                <span class="stringliteral">&quot;traffic_generation_gap_param_two&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#ab0eca59327ee781cddb8fd170bc6d28e">interpacket_gap_trafgen_options</a>.<a class="code" href="structtrafgen__options.html#ae8351c0c4aced5584b653530d5e7e723">param_two</a>,</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                <span class="stringliteral">&quot;flow_control&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a9b37b291808623d607848c54c48f19f4">flow_control</a>,</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                <span class="stringliteral">&quot;byte_counting&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#abc6728769659e18a72dd12549d4f6f94">byte_counting</a>,</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                <span class="stringliteral">&quot;cork&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#ae229f5e5bd4c3689473dcb7b7debea6e">cork</a>,</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                <span class="stringliteral">&quot;nonagle&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#af1d11c3e1d43f04babc48c1c002a31ac">nonagle</a>,</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                <span class="stringliteral">&quot;cc_alg&quot;</span>, &amp;cc_alg,</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                <span class="stringliteral">&quot;elcn&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a773a21e329a31811844f9f26da458e62">elcn</a>,</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                <span class="stringliteral">&quot;lcd&quot;</span>,  &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#aa16b93831301f5b6faf010158327cf67">lcd</a>,</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                <span class="stringliteral">&quot;mtcp&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#aeebdd152f5d7d68a4435b31313550bad">mtcp</a>,</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                <span class="stringliteral">&quot;dscp&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a06c29bb39cf7a6004178e5582949990a">dscp</a>,</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                <span class="stringliteral">&quot;ipmtudiscover&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a182d573decbb50a7691ab088dd630a54">ipmtudiscover</a>,</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                <span class="stringliteral">&quot;dump_prefix&quot;</span>, &amp;<a class="code" href="daemon_8h.html#a016095bb5b1fadba7bc57d2a0d1a75f8">dump_prefix</a>,</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                <span class="stringliteral">&quot;num_extra_socket_options&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a7e76c24f63b5771588d75e427d3df2cc">num_extra_socket_options</a>,</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                <span class="stringliteral">&quot;extra_socket_options&quot;</span>, &amp;extra_options,</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                <span class="comment">/* source settings */</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                <span class="stringliteral">&quot;destination_address&quot;</span>, &amp;destination_host,</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                <span class="stringliteral">&quot;destination_port&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a1af750f008981cf9aacd341e69be6bd3">source_settings</a>.<a class="code" href="structflow__source__settings.html#a04b3a72e499b89c1f658f9000e8bfe8a">destination_port</a>,</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                <span class="stringliteral">&quot;late_connect&quot;</span>, &amp;<a class="code" href="structrequest__add__flow__source.html#a1af750f008981cf9aacd341e69be6bd3">source_settings</a>.<a class="code" href="structflow__source__settings.html#a6e94ce54173e1dfc09a560894ed2b3c3">late_connect</a>);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">if</span> (env-&gt;fault_occurred)</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="preprocessor">#ifndef HAVE_LIBPCAP</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a3aee86084eac437051355cce738de2ef">traffic_dump</a>)</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                XMLRPC_FAIL(env, XMLRPC_TYPE_ERROR, <span class="stringliteral">&quot;Daemon was asked to dump traffic, but wasn&#39;t compiled with libpcap support&quot;</span>);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="comment">/* Check for sanity */</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">if</span> (strlen(bind_address) &gt;= <span class="keyword">sizeof</span>(<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#afcde8c9da11b85204968beb70542dadb">bind_address</a>) - 1 ||</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                <a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a65188cf299b16d1dbc05ceba51d2328a">delay</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>] &lt; 0 || <a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a4f29273c21baece6aabd20a46efdc0c8">duration</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>] &lt; 0 ||</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                <a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a65188cf299b16d1dbc05ceba51d2328a">delay</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>] &lt; 0 || <a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a4f29273c21baece6aabd20a46efdc0c8">duration</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>] &lt; 0 ||</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                <a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a2b2a17fb2fce5fb908dad96b110cf17b">requested_send_buffer_size</a> &lt; 0 || <a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a6f82584854b543c89a1cf9bd21c1ddc2">requested_read_buffer_size</a> &lt; 0 ||</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                <a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a89b7f00123725264aab18759d7bc7258">maximum_block_size</a> &lt; <a class="code" href="common_8h.html#ac1f29ba54415975a2fa23e276fdf8a0f">MIN_BLOCK_SIZE</a> ||</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                strlen(destination_host) &gt;= <span class="keyword">sizeof</span>(<a class="code" href="structrequest__add__flow__source.html#a1af750f008981cf9aacd341e69be6bd3">source_settings</a>.<a class="code" href="structflow__source__settings.html#abc33c5c7eb17c03684e7af4c5fc7254a">destination_host</a>) - 1||</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                <a class="code" href="structrequest__add__flow__source.html#a1af750f008981cf9aacd341e69be6bd3">source_settings</a>.<a class="code" href="structflow__source__settings.html#a04b3a72e499b89c1f658f9000e8bfe8a">destination_port</a> &lt;= 0 || <a class="code" href="structrequest__add__flow__source.html#a1af750f008981cf9aacd341e69be6bd3">source_settings</a>.<a class="code" href="structflow__source__settings.html#a04b3a72e499b89c1f658f9000e8bfe8a">destination_port</a> &gt; 65535 ||</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                strlen(cc_alg) &gt; <a class="code" href="common_8h.html#ae1a783b83d4ba2bb4aa31daeabe67a40">TCP_CA_NAME_MAX</a> ||</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                <a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a7e76c24f63b5771588d75e427d3df2cc">num_extra_socket_options</a> &lt; 0 || <a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a7e76c24f63b5771588d75e427d3df2cc">num_extra_socket_options</a> &gt; <a class="code" href="common_8h.html#a44290cfbe1b4727247d9fc624c6b5f74">MAX_EXTRA_SOCKET_OPTIONS</a> ||</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                xmlrpc_array_size(env, extra_options) != <a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a7e76c24f63b5771588d75e427d3df2cc">num_extra_socket_options</a> ||</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                <a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a06c29bb39cf7a6004178e5582949990a">dscp</a> &lt; 0 || <a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a06c29bb39cf7a6004178e5582949990a">dscp</a> &gt; 255 ||</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                <a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#aacd8b6b923d36ebf4409798b62074320">write_rate</a> &lt; 0 ||</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                <a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#ad632a70ea0d27ceefb51e2a8059a0dae">reporting_interval</a> &lt; 0) {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                XMLRPC_FAIL(env, XMLRPC_TYPE_ERROR, <span class="stringliteral">&quot;Flow settings incorrect&quot;</span>);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        }</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="comment">/* Parse extra socket options */</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a7e76c24f63b5771588d75e427d3df2cc">num_extra_socket_options</a>; i++) {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* buffer = 0;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                <span class="keywordtype">size_t</span> len;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                xmlrpc_value *option, *level = 0, *optname = 0, *value = 0;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                xmlrpc_array_read_item(env, extra_options, i, &amp;option);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                <span class="keywordflow">if</span> (!env-&gt;fault_occurred)</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                        xmlrpc_struct_read_value(env, option, <span class="stringliteral">&quot;level&quot;</span>, &amp;level);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                <span class="keywordflow">if</span> (!env-&gt;fault_occurred)</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                        xmlrpc_struct_read_value(env, option, <span class="stringliteral">&quot;optname&quot;</span>, &amp;optname);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                <span class="keywordflow">if</span> (!env-&gt;fault_occurred)</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                        xmlrpc_struct_read_value(env, option, <span class="stringliteral">&quot;value&quot;</span>, &amp;value);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                <span class="keywordflow">if</span> (!env-&gt;fault_occurred)</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                        xmlrpc_read_int(env, level, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a22210a3991fe95e08e4b43e1840b0394">extra_socket_options</a>[i].<a class="code" href="structflow__settings_1_1extra__socket__options.html#ab4c9283e6c6989000ce3fbb1c10edb21">level</a>);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                <span class="keywordflow">if</span> (!env-&gt;fault_occurred)</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                        xmlrpc_read_int(env, optname, &amp;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a22210a3991fe95e08e4b43e1840b0394">extra_socket_options</a>[i].<a class="code" href="structflow__settings_1_1extra__socket__options.html#a1fb402cd50480d5ee99cc0e7632d4e68">optname</a>);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                <span class="keywordflow">if</span> (!env-&gt;fault_occurred)</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                        xmlrpc_read_base64(env, value, &amp;len, &amp;buffer);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                <span class="keywordflow">if</span> (level)</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                        xmlrpc_DECREF(level);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                <span class="keywordflow">if</span> (optname)</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                        xmlrpc_DECREF(optname);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                <span class="keywordflow">if</span> (value)</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                        xmlrpc_DECREF(value);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                <span class="keywordflow">if</span> (!env-&gt;fault_occurred) {</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                        <span class="keywordflow">if</span> (len &gt; <a class="code" href="common_8h.html#a22d5973f37c892d2137175ec2fee19d5">MAX_EXTRA_SOCKET_OPTION_VALUE_LENGTH</a>) {</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                                free((<span class="keywordtype">void</span> *)buffer);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                                XMLRPC_FAIL(env, XMLRPC_TYPE_ERROR, <span class="stringliteral">&quot;Too long extra socket option length&quot;</span>);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                        }</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                        <a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a22210a3991fe95e08e4b43e1840b0394">extra_socket_options</a>[i].<a class="code" href="structflow__settings_1_1extra__socket__options.html#acc49adee57829cf50c4bf87f80ecf9a0">optlen</a> = len;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                        memcpy(<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a22210a3991fe95e08e4b43e1840b0394">extra_socket_options</a>[i].<a class="code" href="structflow__settings_1_1extra__socket__options.html#a8e75e02f1762c213c74ee92ead514312">optval</a>, buffer, len);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                        free((<span class="keywordtype">void</span> *)buffer);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                }</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                <span class="keywordflow">if</span> (env-&gt;fault_occurred)</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                        <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        }</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        strcpy(<a class="code" href="structrequest__add__flow__source.html#a1af750f008981cf9aacd341e69be6bd3">source_settings</a>.<a class="code" href="structflow__source__settings.html#abc33c5c7eb17c03684e7af4c5fc7254a">destination_host</a>, destination_host);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        strcpy(<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#a1206d0f66388f1f916f1ea237453a8db">cc_alg</a>, cc_alg);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        strcpy(<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>.<a class="code" href="structflow__settings.html#afcde8c9da11b85204968beb70542dadb">bind_address</a>, bind_address);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        request = malloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrequest__add__flow__source.html">request_add_flow_source</a>));</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        request-&gt;<a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a> = <a class="code" href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">settings</a>;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        request-&gt;<a class="code" href="structrequest__add__flow__source.html#a1af750f008981cf9aacd341e69be6bd3">source_settings</a> = <a class="code" href="structrequest__add__flow__source.html#a1af750f008981cf9aacd341e69be6bd3">source_settings</a>;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        rc = <a class="code" href="daemon_8c.html#a4271388fd018c3d910e4839b3747df96">dispatch_request</a>((<span class="keyword">struct</span> request*)request, <a class="code" href="daemon_8h.html#a3a11d078671d380e037fd310d4e614cd">REQUEST_ADD_SOURCE</a>);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">if</span> (rc == -1)</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                XMLRPC_FAIL(env, XMLRPC_INTERNAL_ERROR, request-&gt;<a class="code" href="structrequest__add__flow__source.html#a16433223289d818080e1169ddb2a4118">r</a>.<a class="code" href="structrequest.html#acc214191f4fbfabdedf789adc862b393">error</a>); <span class="comment">/* goto cleanup on failure */</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="comment">/* Return our result. */</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        ret = xmlrpc_build_value(env, <span class="stringliteral">&quot;{s:i,s:s,s:i,s:i}&quot;</span>,</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                <span class="stringliteral">&quot;flow_id&quot;</span>, request-&gt;<a class="code" href="structrequest__add__flow__source.html#ab4289e5e309ec9a5adb22fec56ae8596">flow_id</a>,</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                <span class="stringliteral">&quot;cc_alg&quot;</span>, request-&gt;<a class="code" href="structrequest__add__flow__source.html#ac974a7319b316c385bc510e535da935b">cc_alg</a>,</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                <span class="stringliteral">&quot;real_send_buffer_size&quot;</span>, request-&gt;<a class="code" href="structrequest__add__flow__source.html#ab0929da7238fdda5be2f1d19c498aade">real_send_buffer_size</a>,</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                <span class="stringliteral">&quot;real_read_buffer_size&quot;</span>, request-&gt;<a class="code" href="structrequest__add__flow__source.html#a3bf639175787d9837a68a6794f76b59f">real_read_buffer_size</a>);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;cleanup:</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordflow">if</span> (request)</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                <a class="code" href="fg__definitions_8h.html#a9735559a214ac1d8d9f8ceddfaeca672">free_all</a>(request-&gt;<a class="code" href="structrequest__add__flow__source.html#a16433223289d818080e1169ddb2a4118">r</a>.<a class="code" href="structrequest.html#acc214191f4fbfabdedf789adc862b393">error</a>, request);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <a class="code" href="fg__definitions_8h.html#a9735559a214ac1d8d9f8ceddfaeca672">free_all</a>(destination_host, cc_alg, bind_address);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordflow">if</span> (extra_options)</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                xmlrpc_DECREF(extra_options);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keywordflow">if</span> (env-&gt;fault_occurred)</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                <a class="code" href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a>(LOG_WARNING, <span class="stringliteral">&quot;method add_flow_source failed: %s&quot;</span>,</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                        env-&gt;fault_string);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_WARNING, <span class="stringliteral">&quot;method add_flow_source successful&quot;</span>);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;}</div><div class="ttc" id="structflow__settings_html_a89b7f00123725264aab18759d7bc7258"><div class="ttname"><a href="structflow__settings.html#a89b7f00123725264aab18759d7bc7258">flow_settings::maximum_block_size</a></div><div class="ttdeci">int maximum_block_size</div><div class="ttdoc">Application buffer size in bytes (option -U). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00201">common.h:201</a></div></div>
<div class="ttc" id="structflow__settings_html_aeebdd152f5d7d68a4435b31313550bad"><div class="ttname"><a href="structflow__settings.html#aeebdd152f5d7d68a4435b31313550bad">flow_settings::mtcp</a></div><div class="ttdeci">int mtcp</div><div class="ttdoc">Set TCP_MTCP (15) on test socket (option -O). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00242">common.h:242</a></div></div>
<div class="ttc" id="daemon_8h_html_a3a11d078671d380e037fd310d4e614cd"><div class="ttname"><a href="daemon_8h.html#a3a11d078671d380e037fd310d4e614cd">REQUEST_ADD_SOURCE</a></div><div class="ttdeci">#define REQUEST_ADD_SOURCE</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00174">daemon.h:174</a></div></div>
<div class="ttc" id="structflow__settings_html_a7e76c24f63b5771588d75e427d3df2cc"><div class="ttname"><a href="structflow__settings.html#a7e76c24f63b5771588d75e427d3df2cc">flow_settings::num_extra_socket_options</a></div><div class="ttdeci">int num_extra_socket_options</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00262">common.h:262</a></div></div>
<div class="ttc" id="structflow__settings_html_aa16b93831301f5b6faf010158327cf67"><div class="ttname"><a href="structflow__settings.html#aa16b93831301f5b6faf010158327cf67">flow_settings::lcd</a></div><div class="ttdeci">int lcd</div><div class="ttdoc">Set TCP_LCD (21) on test socket (option -O). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00240">common.h:240</a></div></div>
<div class="ttc" id="common_8h_html_a44290cfbe1b4727247d9fc624c6b5f74"><div class="ttname"><a href="common_8h.html#a44290cfbe1b4727247d9fc624c6b5f74">MAX_EXTRA_SOCKET_OPTIONS</a></div><div class="ttdeci">#define MAX_EXTRA_SOCKET_OPTIONS</div><div class="ttdoc">Max number of arbitrary extra socket options which may sent to the deamon. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00068">common.h:68</a></div></div>
<div class="ttc" id="daemon_8h_html_a016095bb5b1fadba7bc57d2a0d1a75f8"><div class="ttname"><a href="daemon_8h.html#a016095bb5b1fadba7bc57d2a0d1a75f8">dump_prefix</a></div><div class="ttdeci">char * dump_prefix</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00272">daemon.h:272</a></div></div>
<div class="ttc" id="structflow__settings_html_a2b2a17fb2fce5fb908dad96b110cf17b"><div class="ttname"><a href="structflow__settings.html#a2b2a17fb2fce5fb908dad96b110cf17b">flow_settings::requested_send_buffer_size</a></div><div class="ttdeci">int requested_send_buffer_size</div><div class="ttdoc">Request sender buffer in bytes (option -B). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00196">common.h:196</a></div></div>
<div class="ttc" id="fg__log_8c_html_a2aea54bb4eab90a69510db34326d82f4"><div class="ttname"><a href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a></div><div class="ttdeci">void logging(int priority, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="fg__log_8c_source.html#l00069">fg_log.c:69</a></div></div>
<div class="ttc" id="common_8h_html_a22d5973f37c892d2137175ec2fee19d5"><div class="ttname"><a href="common_8h.html#a22d5973f37c892d2137175ec2fee19d5">MAX_EXTRA_SOCKET_OPTION_VALUE_LENGTH</a></div><div class="ttdeci">#define MAX_EXTRA_SOCKET_OPTION_VALUE_LENGTH</div><div class="ttdoc">Ensures extra options are limited in length on both controller and deamon. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00071">common.h:71</a></div></div>
<div class="ttc" id="structflow__settings_html_aacd8b6b923d36ebf4409798b62074320"><div class="ttname"><a href="structflow__settings.html#aacd8b6b923d36ebf4409798b62074320">flow_settings::write_rate</a></div><div class="ttdeci">int write_rate</div><div class="ttdoc">The actual rate we should send. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00220">common.h:220</a></div></div>
<div class="ttc" id="common_8h_html_ae1a783b83d4ba2bb4aa31daeabe67a40"><div class="ttname"><a href="common_8h.html#ae1a783b83d4ba2bb4aa31daeabe67a40">TCP_CA_NAME_MAX</a></div><div class="ttdeci">#define TCP_CA_NAME_MAX</div><div class="ttdoc">Max size of the congestion control algorithm specifier string. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00075">common.h:75</a></div></div>
<div class="ttc" id="structflow__source__settings_html_abc33c5c7eb17c03684e7af4c5fc7254a"><div class="ttname"><a href="structflow__source__settings.html#abc33c5c7eb17c03684e7af4c5fc7254a">flow_source_settings::destination_host</a></div><div class="ttdeci">char destination_host[256]</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00065">daemon.h:65</a></div></div>
<div class="ttc" id="structflow__settings_html_a65188cf299b16d1dbc05ceba51d2328a"><div class="ttname"><a href="structflow__settings.html#a65188cf299b16d1dbc05ceba51d2328a">flow_settings::delay</a></div><div class="ttdeci">double delay[2]</div><div class="ttdoc">Delay of flow in seconds (option -Y). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00188">common.h:188</a></div></div>
<div class="ttc" id="structrequest__add__flow__source_html_a411e57f07115c878141acb7df1a6064f"><div class="ttname"><a href="structrequest__add__flow__source.html#a411e57f07115c878141acb7df1a6064f">request_add_flow_source::settings</a></div><div class="ttdeci">struct flow_settings settings</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00210">daemon.h:210</a></div></div>
<div class="ttc" id="structrequest__add__flow__source_html_ab0929da7238fdda5be2f1d19c498aade"><div class="ttname"><a href="structrequest__add__flow__source.html#ab0929da7238fdda5be2f1d19c498aade">request_add_flow_source::real_send_buffer_size</a></div><div class="ttdeci">int real_send_buffer_size</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00216">daemon.h:216</a></div></div>
<div class="ttc" id="daemon_8c_html_a4271388fd018c3d910e4839b3747df96"><div class="ttname"><a href="daemon_8c.html#a4271388fd018c3d910e4839b3747df96">dispatch_request</a></div><div class="ttdeci">int dispatch_request(struct request *request, int type)</div><div class="ttdoc">Dispatch a request to daemon loop. </div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l01485">daemon.c:1485</a></div></div>
<div class="ttc" id="structflow__settings_1_1extra__socket__options_html_acc49adee57829cf50c4bf87f80ecf9a0"><div class="ttname"><a href="structflow__settings_1_1extra__socket__options.html#acc49adee57829cf50c4bf87f80ecf9a0">flow_settings::extra_socket_options::optlen</a></div><div class="ttdeci">int optlen</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00259">common.h:259</a></div></div>
<div class="ttc" id="structflow__settings_1_1extra__socket__options_html_a8e75e02f1762c213c74ee92ead514312"><div class="ttname"><a href="structflow__settings_1_1extra__socket__options.html#a8e75e02f1762c213c74ee92ead514312">flow_settings::extra_socket_options::optval</a></div><div class="ttdeci">char optval[MAX_EXTRA_SOCKET_OPTION_VALUE_LENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00260">common.h:260</a></div></div>
<div class="ttc" id="structflow__settings_html_ae229f5e5bd4c3689473dcb7b7debea6e"><div class="ttname"><a href="structflow__settings.html#ae229f5e5bd4c3689473dcb7b7debea6e">flow_settings::cork</a></div><div class="ttdeci">int cork</div><div class="ttdoc">Sets SO_DEBUG on test socket (option -O). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00232">common.h:232</a></div></div>
<div class="ttc" id="structtrafgen__options_html_ae8351c0c4aced5584b653530d5e7e723"><div class="ttname"><a href="structtrafgen__options.html#ae8351c0c4aced5584b653530d5e7e723">trafgen_options::param_two</a></div><div class="ttdeci">double param_two</div><div class="ttdoc">Second mathematical parameter of the distribution, if required. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00172">common.h:172</a></div></div>
<div class="ttc" id="debug_8h_html_ae420d5a1d63f99c6a2a386c4eea54250"><div class="ttname"><a href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a></div><div class="ttdeci">#define DEBUG_MSG(LVL, MSG,...)</div><div class="ttdoc">Print debug message to standard error. </div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00049">debug.h:49</a></div></div>
<div class="ttc" id="structflow__settings_html_a1206d0f66388f1f916f1ea237453a8db"><div class="ttname"><a href="structflow__settings.html#a1206d0f66388f1f916f1ea237453a8db">flow_settings::cc_alg</a></div><div class="ttdeci">char cc_alg[TCP_CA_NAME_MAX]</div><div class="ttdoc">Set congestion control algorithm ALG on test socket (option -O). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00236">common.h:236</a></div></div>
<div class="ttc" id="structflow__settings_html_a182d573decbb50a7691ab088dd630a54"><div class="ttname"><a href="structflow__settings.html#a182d573decbb50a7691ab088dd630a54">flow_settings::ipmtudiscover</a></div><div class="ttdeci">int ipmtudiscover</div><div class="ttdoc">Set IP_MTU_DISCOVER on test socket (option -O). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00246">common.h:246</a></div></div>
<div class="ttc" id="structflow__settings_html_addf539178c60faab6c8fee7a54630fbc"><div class="ttname"><a href="structflow__settings.html#addf539178c60faab6c8fee7a54630fbc">flow_settings::pushy</a></div><div class="ttdeci">int pushy</div><div class="ttdoc">Do not iterate through select() to continue sending in case block size did not suffice to fill sendin...</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00213">common.h:213</a></div></div>
<div class="ttc" id="structrequest_html_acc214191f4fbfabdedf789adc862b393"><div class="ttname"><a href="structrequest.html#acc214191f4fbfabdedf789adc862b393">request::error</a></div><div class="ttdeci">char * error</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00187">daemon.h:187</a></div></div>
<div class="ttc" id="common_8h_html_ac1f29ba54415975a2fa23e276fdf8a0f"><div class="ttname"><a href="common_8h.html#ac1f29ba54415975a2fa23e276fdf8a0f">MIN_BLOCK_SIZE</a></div><div class="ttdeci">#define MIN_BLOCK_SIZE</div><div class="ttdoc">Minium block (message) size we can send. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00079">common.h:79</a></div></div>
<div class="ttc" id="structrequest__add__flow__source_html"><div class="ttname"><a href="structrequest__add__flow__source.html">request_add_flow_source</a></div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00206">daemon.h:206</a></div></div>
<div class="ttc" id="fg__definitions_8h_html_a239dd5192fcd165ce89d2c6d08e34993"><div class="ttname"><a href="fg__definitions_8h.html#a239dd5192fcd165ce89d2c6d08e34993">UNUSED_ARGUMENT</a></div><div class="ttdeci">#define UNUSED_ARGUMENT(x)</div><div class="ttdoc">Suppress warning for unused argument. </div><div class="ttdef"><b>Definition:</b> <a href="fg__definitions_8h_source.html#l00038">fg_definitions.h:38</a></div></div>
<div class="ttc" id="structflow__settings_html_a06c29bb39cf7a6004178e5582949990a"><div class="ttname"><a href="structflow__settings.html#a06c29bb39cf7a6004178e5582949990a">flow_settings::dscp</a></div><div class="ttdeci">int dscp</div><div class="ttdoc">DSCP value for TOS byte (option -D). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00244">common.h:244</a></div></div>
<div class="ttc" id="structflow__settings_html_a6f82584854b543c89a1cf9bd21c1ddc2"><div class="ttname"><a href="structflow__settings.html#a6f82584854b543c89a1cf9bd21c1ddc2">flow_settings::requested_read_buffer_size</a></div><div class="ttdeci">int requested_read_buffer_size</div><div class="ttdoc">Request receiver buffer, advertised window in bytes (option -W). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00198">common.h:198</a></div></div>
<div class="ttc" id="structflow__settings_html_aea33a5413dbace7b756f93afdea7963d"><div class="ttname"><a href="structflow__settings.html#aea33a5413dbace7b756f93afdea7963d">flow_settings::route_record</a></div><div class="ttdeci">int route_record</div><div class="ttdoc">Sets ROUTE_RECORD on test socket (option -O). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00208">common.h:208</a></div></div>
<div class="ttc" id="structflow__source__settings_html_a6e94ce54173e1dfc09a560894ed2b3c3"><div class="ttname"><a href="structflow__source__settings.html#a6e94ce54173e1dfc09a560894ed2b3c3">flow_source_settings::late_connect</a></div><div class="ttdeci">int late_connect</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00068">daemon.h:68</a></div></div>
<div class="ttc" id="structflow__settings_html_a22210a3991fe95e08e4b43e1840b0394"><div class="ttname"><a href="structflow__settings.html#a22210a3991fe95e08e4b43e1840b0394">flow_settings::extra_socket_options</a></div><div class="ttdeci">struct flow_settings::extra_socket_options extra_socket_options[MAX_EXTRA_SOCKET_OPTIONS]</div></div>
<div class="ttc" id="fg__definitions_8h_html_a9735559a214ac1d8d9f8ceddfaeca672"><div class="ttname"><a href="fg__definitions_8h.html#a9735559a214ac1d8d9f8ceddfaeca672">free_all</a></div><div class="ttdeci">#define free_all(...)</div><div class="ttdoc">To free() an arbitrary number of variables. </div><div class="ttdef"><b>Definition:</b> <a href="fg__definitions_8h_source.html#l00059">fg_definitions.h:59</a></div></div>
<div class="ttc" id="structrequest__add__flow__source_html_ab4289e5e309ec9a5adb22fec56ae8596"><div class="ttname"><a href="structrequest__add__flow__source.html#ab4289e5e309ec9a5adb22fec56ae8596">request_add_flow_source::flow_id</a></div><div class="ttdeci">int flow_id</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00214">daemon.h:214</a></div></div>
<div class="ttc" id="structrequest__add__flow__source_html_a16433223289d818080e1169ddb2a4118"><div class="ttname"><a href="structrequest__add__flow__source.html#a16433223289d818080e1169ddb2a4118">request_add_flow_source::r</a></div><div class="ttdeci">struct request r</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00208">daemon.h:208</a></div></div>
<div class="ttc" id="structrequest__add__flow__source_html_a1af750f008981cf9aacd341e69be6bd3"><div class="ttname"><a href="structrequest__add__flow__source.html#a1af750f008981cf9aacd341e69be6bd3">request_add_flow_source::source_settings</a></div><div class="ttdeci">struct flow_source_settings source_settings</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00211">daemon.h:211</a></div></div>
<div class="ttc" id="structflow__settings_html_aa32e335e786e3b6634824fa757c285b9"><div class="ttname"><a href="structflow__settings.html#aa32e335e786e3b6634824fa757c285b9">flow_settings::random_seed</a></div><div class="ttdeci">unsigned random_seed</div><div class="ttdoc">Random seed to use (default: read /dev/urandom) (option -J). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00223">common.h:223</a></div></div>
<div class="ttc" id="structflow__settings_html_a4094e6a3e73864f3e3f84a977d68a194"><div class="ttname"><a href="structflow__settings.html#a4094e6a3e73864f3e3f84a977d68a194">flow_settings::response_trafgen_options</a></div><div class="ttdeci">struct trafgen_options response_trafgen_options</div><div class="ttdoc">Stochastic traffic generation settings for the response size. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00251">common.h:251</a></div></div>
<div class="ttc" id="structrequest__add__flow__source_html_a3bf639175787d9837a68a6794f76b59f"><div class="ttname"><a href="structrequest__add__flow__source.html#a3bf639175787d9837a68a6794f76b59f">request_add_flow_source::real_read_buffer_size</a></div><div class="ttdeci">int real_read_buffer_size</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00217">daemon.h:217</a></div></div>
<div class="ttc" id="structflow__settings_html_ab0eca59327ee781cddb8fd170bc6d28e"><div class="ttname"><a href="structflow__settings.html#ab0eca59327ee781cddb8fd170bc6d28e">flow_settings::interpacket_gap_trafgen_options</a></div><div class="ttdeci">struct trafgen_options interpacket_gap_trafgen_options</div><div class="ttdoc">Stochastic traffic generation settings for the interpacket gap. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00253">common.h:253</a></div></div>
<div class="ttc" id="structflow__source__settings_html_a04b3a72e499b89c1f658f9000e8bfe8a"><div class="ttname"><a href="structflow__source__settings.html#a04b3a72e499b89c1f658f9000e8bfe8a">flow_source_settings::destination_port</a></div><div class="ttdeci">int destination_port</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00066">daemon.h:66</a></div></div>
<div class="ttc" id="structflow__settings_html_a773a21e329a31811844f9f26da458e62"><div class="ttname"><a href="structflow__settings.html#a773a21e329a31811844f9f26da458e62">flow_settings::elcn</a></div><div class="ttdeci">int elcn</div><div class="ttdoc">Set TCP_ELCN (20) on test socket (option -O). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00238">common.h:238</a></div></div>
<div class="ttc" id="structflow__source__settings_html"><div class="ttname"><a href="structflow__source__settings.html">flow_source_settings</a></div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00063">daemon.h:63</a></div></div>
<div class="ttc" id="structrequest__add__flow__source_html_ac974a7319b316c385bc510e535da935b"><div class="ttname"><a href="structrequest__add__flow__source.html#ac974a7319b316c385bc510e535da935b">request_add_flow_source::cc_alg</a></div><div class="ttdeci">char cc_alg[TCP_CA_NAME_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00215">daemon.h:215</a></div></div>
<div class="ttc" id="structflow__settings_html_a3aee86084eac437051355cce738de2ef"><div class="ttname"><a href="structflow__settings.html#a3aee86084eac437051355cce738de2ef">flow_settings::traffic_dump</a></div><div class="ttdeci">int traffic_dump</div><div class="ttdoc">Dump traffic using libpcap (option -M). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00204">common.h:204</a></div></div>
<div class="ttc" id="common_8h_html_a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6"><div class="ttname"><a href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a></div><div class="ttdoc">Read operation. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00108">common.h:108</a></div></div>
<div class="ttc" id="structflow__settings_html_ae1bb84bc89626d9c6950b41a7a124ee2"><div class="ttname"><a href="structflow__settings.html#ae1bb84bc89626d9c6950b41a7a124ee2">flow_settings::so_debug</a></div><div class="ttdeci">int so_debug</div><div class="ttdoc">Sets SO_DEBUG on test socket (option -O). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00206">common.h:206</a></div></div>
<div class="ttc" id="common_8h_html_a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc"><div class="ttname"><a href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a></div><div class="ttdoc">Write operation. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00106">common.h:106</a></div></div>
<div class="ttc" id="structrequest_html"><div class="ttname"><a href="structrequest.html">request</a></div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00179">daemon.h:179</a></div></div>
<div class="ttc" id="structflow__settings_html_a4f29273c21baece6aabd20a46efdc0c8"><div class="ttname"><a href="structflow__settings.html#a4f29273c21baece6aabd20a46efdc0c8">flow_settings::duration</a></div><div class="ttdeci">double duration[2]</div><div class="ttdoc">Duration of flow in seconds (option -T). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00190">common.h:190</a></div></div>
<div class="ttc" id="structflow__settings_html_a1144784676f7ead2cf557fa96838ddb2"><div class="ttname"><a href="structflow__settings.html#a1144784676f7ead2cf557fa96838ddb2">flow_settings::flow_id</a></div><div class="ttdeci">int flow_id</div><div class="ttdoc">Flow ID maintained by controller. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00186">common.h:186</a></div></div>
<div class="ttc" id="structflow__settings_html_a9b37b291808623d607848c54c48f19f4"><div class="ttname"><a href="structflow__settings.html#a9b37b291808623d607848c54c48f19f4">flow_settings::flow_control</a></div><div class="ttdeci">int flow_control</div><div class="ttdoc">Stop flow if it is experiencing local congestion (option -C). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00226">common.h:226</a></div></div>
<div class="ttc" id="structflow__settings_html_abc6728769659e18a72dd12549d4f6f94"><div class="ttname"><a href="structflow__settings.html#abc6728769659e18a72dd12549d4f6f94">flow_settings::byte_counting</a></div><div class="ttdeci">int byte_counting</div><div class="ttdoc">Enumerate bytes in payload instead of sending zeros (option -E). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00229">common.h:229</a></div></div>
<div class="ttc" id="structtrafgen__options_html_aef412154fd2823aeb4765a8304d9849b"><div class="ttname"><a href="structtrafgen__options.html#aef412154fd2823aeb4765a8304d9849b">trafgen_options::param_one</a></div><div class="ttdeci">double param_one</div><div class="ttdoc">First mathemathical parameter of the distribution. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00170">common.h:170</a></div></div>
<div class="ttc" id="structflow__settings_1_1extra__socket__options_html_ab4c9283e6c6989000ce3fbb1c10edb21"><div class="ttname"><a href="structflow__settings_1_1extra__socket__options.html#ab4c9283e6c6989000ce3fbb1c10edb21">flow_settings::extra_socket_options::level</a></div><div class="ttdeci">int level</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00257">common.h:257</a></div></div>
<div class="ttc" id="structtrafgen__options_html_a3d575b99d686962d4171c0dd7840cd6e"><div class="ttname"><a href="structtrafgen__options.html#a3d575b99d686962d4171c0dd7840cd6e">trafgen_options::distribution</a></div><div class="ttdeci">enum distribution_t distribution</div><div class="ttdoc">The stochastic distribution to draw values from. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00168">common.h:168</a></div></div>
<div class="ttc" id="structflow__settings_1_1extra__socket__options_html_a1fb402cd50480d5ee99cc0e7632d4e68"><div class="ttname"><a href="structflow__settings_1_1extra__socket__options.html#a1fb402cd50480d5ee99cc0e7632d4e68">flow_settings::extra_socket_options::optname</a></div><div class="ttdeci">int optname</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00258">common.h:258</a></div></div>
<div class="ttc" id="structflow__settings_html_afcde8c9da11b85204968beb70542dadb"><div class="ttname"><a href="structflow__settings.html#afcde8c9da11b85204968beb70542dadb">flow_settings::bind_address</a></div><div class="ttdeci">char bind_address[1000]</div><div class="ttdoc">The interface address for the flow (used by daemon). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00183">common.h:183</a></div></div>
<div class="ttc" id="structflow__settings_html_af1d11c3e1d43f04babc48c1c002a31ac"><div class="ttname"><a href="structflow__settings.html#af1d11c3e1d43f04babc48c1c002a31ac">flow_settings::nonagle</a></div><div class="ttdeci">int nonagle</div><div class="ttdoc">Disable nagle algorithm on test socket (option -O). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00234">common.h:234</a></div></div>
<div class="ttc" id="structflow__settings_html_a58ee2ce95a7ee3b8d2a06f3a55ccaf07"><div class="ttname"><a href="structflow__settings.html#a58ee2ce95a7ee3b8d2a06f3a55ccaf07">flow_settings::shutdown</a></div><div class="ttdeci">int shutdown</div><div class="ttdoc">Shutdown socket after test flow (option -N). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00215">common.h:215</a></div></div>
<div class="ttc" id="structflow__settings_html"><div class="ttname"><a href="structflow__settings.html">flow_settings</a></div><div class="ttdoc">Settings that describe a flow between from a endpoint&amp;#39;s perspective. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00181">common.h:181</a></div></div>
<div class="ttc" id="structflow__settings_html_a51b97d90a014086a16cd9025179419d8"><div class="ttname"><a href="structflow__settings.html#a51b97d90a014086a16cd9025179419d8">flow_settings::request_trafgen_options</a></div><div class="ttdeci">struct trafgen_options request_trafgen_options</div><div class="ttdoc">Stochastic traffic generation settings for the request size. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00249">common.h:249</a></div></div>
<div class="ttc" id="structflow__settings_html_ad632a70ea0d27ceefb51e2a8059a0dae"><div class="ttname"><a href="structflow__settings.html#ad632a70ea0d27ceefb51e2a8059a0dae">flow_settings::reporting_interval</a></div><div class="ttdeci">double reporting_interval</div><div class="ttdoc">Interval to report flow on screen (option -i). </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00193">common.h:193</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2328283204a516f2fd89f05f7818189d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int bind_rpc_server </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>bind_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="fg__rpc__server_8c_source.html#l00784">784</a> of file <a class="el" href="fg__rpc__server_8c_source.html">fg_rpc_server.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                                                           {</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <span class="keywordtype">int</span> rc;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        <span class="keywordtype">int</span> fd;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <span class="keywordtype">int</span> optval;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        <span class="keyword">struct </span>addrinfo hints, *res, *ressave;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        <span class="keywordtype">char</span> tmp_port[100];</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        bzero(&amp;hints, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> addrinfo));</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        hints.ai_flags = AI_PASSIVE | AI_NUMERICSERV;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        hints.ai_family = AF_UNSPEC;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        hints.ai_socktype = SOCK_STREAM;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        sprintf(tmp_port, <span class="stringliteral">&quot;%u&quot;</span>, <a class="code" href="flowgrindd_8c.html#a93a340e516c0d6c60f5826ee5f498e21">port</a>);</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <span class="keywordflow">if</span> ((rc = getaddrinfo(bind_addr, tmp_port,</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                                &amp;hints, &amp;res)) != 0) {</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                <a class="code" href="fg__error_8h.html#abcfc1fb29ee2f39829ae11ab456ab040">critx</a>( <span class="stringliteral">&quot;Failed to find address to bind rpc_server: %s\n&quot;</span>,</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                        gai_strerror(rc));</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        }</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        ressave = res;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <span class="comment">/* try to bind the first succeeding socket of</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">           the returned addresses (libxmlrpc only supports one fd)</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">        */</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <span class="keywordflow">do</span> {</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                fd = socket(res-&gt;ai_family, res-&gt;ai_socktype,</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                res-&gt;ai_protocol);</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                <span class="keywordflow">if</span> (fd &lt; 0)</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                <span class="comment">/* ignore old client connections in TIME_WAIT */</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                optval = 1;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                setsockopt(fd, SOL_SOCKET, SO_REUSEADDR, &amp;optval, <span class="keyword">sizeof</span>(optval));</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                <span class="comment">/* Disable Nagle algorithm to reduce latency */</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                setsockopt(fd, IPPROTO_TCP, TCP_NODELAY, &amp;optval, <span class="keyword">sizeof</span>(optval));</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                <span class="keywordflow">if</span> (bind(fd, res-&gt;ai_addr, res-&gt;ai_addrlen) == 0)</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                close(fd);</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        } <span class="keywordflow">while</span> ((res = res-&gt;ai_next) != NULL);</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <span class="keywordflow">if</span> (res == NULL) {</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                <a class="code" href="fg__error_8h.html#abe3691984c9be3f886d23938335ea8a1">crit</a>(<span class="stringliteral">&quot;failed to bind RPC listen socket&quot;</span>);</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                freeaddrinfo(ressave);</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        }</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        <span class="keywordflow">return</span> fd;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;}</div><div class="ttc" id="flowgrindd_8c_html_a93a340e516c0d6c60f5826ee5f498e21"><div class="ttname"><a href="flowgrindd_8c.html#a93a340e516c0d6c60f5826ee5f498e21">port</a></div><div class="ttdeci">static unsigned port</div><div class="ttdef"><b>Definition:</b> <a href="flowgrindd_8c_source.html#l00095">flowgrindd.c:95</a></div></div>
<div class="ttc" id="fg__error_8h_html_abcfc1fb29ee2f39829ae11ab456ab040"><div class="ttname"><a href="fg__error_8h.html#abcfc1fb29ee2f39829ae11ab456ab040">critx</a></div><div class="ttdeci">#define critx(...)</div><div class="ttdoc">To report an critical error w/o a system error message. </div><div class="ttdef"><b>Definition:</b> <a href="fg__error_8h_source.html#l00040">fg_error.h:40</a></div></div>
<div class="ttc" id="fg__error_8h_html_abe3691984c9be3f886d23938335ea8a1"><div class="ttname"><a href="fg__error_8h.html#abe3691984c9be3f886d23938335ea8a1">crit</a></div><div class="ttdeci">#define crit(...)</div><div class="ttdoc">To report an critical error w/ the corresponding system error message. </div><div class="ttdef"><b>Definition:</b> <a href="fg__error_8h_source.html#l00036">fg_error.h:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad0084c304767d8403123e53f562c7cbb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_rpc_server </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfg__rpc__server.html">fg_rpc_server</a> *&#160;</td>
          <td class="paramname"><em>server</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>rpc_bind_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the xmlrpc server. </p>
<p>This function initializes the xmlrpc environment, registers exported methods and binds to the control port. </p>

<p>Definition at line <a class="el" href="fg__rpc__server_8c_source.html#l00835">835</a> of file <a class="el" href="fg__rpc__server_8c_source.html">fg_rpc_server.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;{</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        xmlrpc_registry * registryP;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        xmlrpc_env *env = &amp;(server-&gt;<a class="code" href="structfg__rpc__server.html#a8836ac2554cec646a01a160eab391d45">env</a>);</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        memset(&amp;(server-&gt;<a class="code" href="structfg__rpc__server.html#a7d67f166831ed00d0eefffe7e0fc1487">parms</a>), 0, <span class="keyword">sizeof</span>(server-&gt;<a class="code" href="structfg__rpc__server.html#a7d67f166831ed00d0eefffe7e0fc1487">parms</a>));</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        xmlrpc_env_init(env);</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        registryP = xmlrpc_registry_new(env);</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        xmlrpc_registry_add_method(env, registryP, NULL, <span class="stringliteral">&quot;add_flow_destination&quot;</span>, &amp;<a class="code" href="fg__rpc__server_8c.html#ad1401628a7594a7835fcdfabefefd689">add_flow_destination</a>, NULL);</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        xmlrpc_registry_add_method(env, registryP, NULL, <span class="stringliteral">&quot;add_flow_source&quot;</span>, &amp;<a class="code" href="fg__rpc__server_8c.html#a55fd54a0087dd0ac821433cbda1f65bd">add_flow_source</a>, NULL);</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        xmlrpc_registry_add_method(env, registryP, NULL, <span class="stringliteral">&quot;start_flows&quot;</span>, &amp;<a class="code" href="fg__rpc__server_8c.html#aa474434b5dc6f7e1a4ca9af98382c37f">start_flows</a>, NULL);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        xmlrpc_registry_add_method(env, registryP, NULL, <span class="stringliteral">&quot;get_reports&quot;</span>, &amp;<a class="code" href="fg__rpc__server_8c.html#a704160b94299ac9000d1c48c41d866a5">method_get_reports</a>, NULL);</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        xmlrpc_registry_add_method(env, registryP, NULL, <span class="stringliteral">&quot;stop_flow&quot;</span>, &amp;<a class="code" href="fg__rpc__server_8c.html#a1ed767ac2965ae35b09e74b50b2ba9a5">method_stop_flow</a>, NULL);</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        xmlrpc_registry_add_method(env, registryP, NULL, <span class="stringliteral">&quot;get_version&quot;</span>, &amp;<a class="code" href="fg__rpc__server_8c.html#ae3418ca5436aaeb5b83c53ae80752329">method_get_version</a>, NULL);</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        xmlrpc_registry_add_method(env, registryP, NULL, <span class="stringliteral">&quot;get_status&quot;</span>, &amp;<a class="code" href="fg__rpc__server_8c.html#a82089af015ac3c47e11de91d23ee09a3">method_get_status</a>, NULL);</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        xmlrpc_registry_add_method(env, registryP, NULL, <span class="stringliteral">&quot;get_uuid&quot;</span>, &amp;<a class="code" href="fg__rpc__server_8c.html#a0b6b9e3fdcd13d429b8a223e68a88477">method_get_uuid</a>, NULL);</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <span class="comment">/* In the modern form of the Abyss API, we supply parameters in memory</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment">           like a normal API.  We select the modern form by setting</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment">           config_file_name to NULL:</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment">        */</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        server-&gt;<a class="code" href="structfg__rpc__server.html#a7d67f166831ed00d0eefffe7e0fc1487">parms</a>.config_file_name  = NULL;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        server-&gt;<a class="code" href="structfg__rpc__server.html#a7d67f166831ed00d0eefffe7e0fc1487">parms</a>.registryP         = registryP;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        server-&gt;<a class="code" href="structfg__rpc__server.html#a7d67f166831ed00d0eefffe7e0fc1487">parms</a>.socket_bound      = 1;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        server-&gt;<a class="code" href="structfg__rpc__server.html#a7d67f166831ed00d0eefffe7e0fc1487">parms</a>.log_file_name     = NULL; <span class="comment">/*&quot;/tmp/xmlrpc_log&quot;;*/</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        <span class="comment">/* Increase HTTP keep-alive duration. Using defaults the amount of</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">         * sockets in TIME_WAIT state would become too high.</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        server-&gt;<a class="code" href="structfg__rpc__server.html#a7d67f166831ed00d0eefffe7e0fc1487">parms</a>.keepalive_timeout = 60;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        server-&gt;<a class="code" href="structfg__rpc__server.html#a7d67f166831ed00d0eefffe7e0fc1487">parms</a>.keepalive_max_conn = 1000;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <span class="comment">/* Disable introspection */</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        server-&gt;<a class="code" href="structfg__rpc__server.html#a7d67f166831ed00d0eefffe7e0fc1487">parms</a>.dont_advertise = 1;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        <a class="code" href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a>(LOG_NOTICE, <span class="stringliteral">&quot;running XML-RPC server on port %u&quot;</span>, <a class="code" href="flowgrindd_8c.html#a93a340e516c0d6c60f5826ee5f498e21">port</a>);</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        printf(<span class="stringliteral">&quot;Running XML-RPC server...\n&quot;</span>);</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        server-&gt;<a class="code" href="structfg__rpc__server.html#a7d67f166831ed00d0eefffe7e0fc1487">parms</a>.socket_handle = <a class="code" href="fg__rpc__server_8c.html#a2328283204a516f2fd89f05f7818189d">bind_rpc_server</a>(<a class="code" href="flowgrindd_8c.html#a38267260bb75d9914c4d82d7a5aa4cd5">rpc_bind_addr</a>, <a class="code" href="flowgrindd_8c.html#a93a340e516c0d6c60f5826ee5f498e21">port</a>);</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;}</div><div class="ttc" id="fg__rpc__server_8c_html_a704160b94299ac9000d1c48c41d866a5"><div class="ttname"><a href="fg__rpc__server_8c.html#a704160b94299ac9000d1c48c41d866a5">method_get_reports</a></div><div class="ttdeci">static xmlrpc_value * method_get_reports(xmlrpc_env *const env, xmlrpc_value *const param_array, void *const user_data)</div><div class="ttdoc">To get the reports from the daemon. </div><div class="ttdef"><b>Definition:</b> <a href="fg__rpc__server_8c_source.html#l00518">fg_rpc_server.c:518</a></div></div>
<div class="ttc" id="flowgrindd_8c_html_a38267260bb75d9914c4d82d7a5aa4cd5"><div class="ttname"><a href="flowgrindd_8c.html#a38267260bb75d9914c4d82d7a5aa4cd5">rpc_bind_addr</a></div><div class="ttdeci">static char * rpc_bind_addr</div><div class="ttdef"><b>Definition:</b> <a href="flowgrindd_8c_source.html#l00098">flowgrindd.c:98</a></div></div>
<div class="ttc" id="fg__rpc__server_8c_html_a1ed767ac2965ae35b09e74b50b2ba9a5"><div class="ttname"><a href="fg__rpc__server_8c.html#a1ed767ac2965ae35b09e74b50b2ba9a5">method_stop_flow</a></div><div class="ttdeci">static xmlrpc_value * method_stop_flow(xmlrpc_env *const env, xmlrpc_value *const param_array, void *const user_data)</div><div class="ttdef"><b>Definition:</b> <a href="fg__rpc__server_8c_source.html#l00623">fg_rpc_server.c:623</a></div></div>
<div class="ttc" id="fg__rpc__server_8c_html_a2328283204a516f2fd89f05f7818189d"><div class="ttname"><a href="fg__rpc__server_8c.html#a2328283204a516f2fd89f05f7818189d">bind_rpc_server</a></div><div class="ttdeci">static int bind_rpc_server(char *bind_addr, unsigned port)</div><div class="ttdef"><b>Definition:</b> <a href="fg__rpc__server_8c_source.html#l00784">fg_rpc_server.c:784</a></div></div>
<div class="ttc" id="fg__log_8c_html_a2aea54bb4eab90a69510db34326d82f4"><div class="ttname"><a href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a></div><div class="ttdeci">void logging(int priority, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="fg__log_8c_source.html#l00069">fg_log.c:69</a></div></div>
<div class="ttc" id="flowgrindd_8c_html_a93a340e516c0d6c60f5826ee5f498e21"><div class="ttname"><a href="flowgrindd_8c.html#a93a340e516c0d6c60f5826ee5f498e21">port</a></div><div class="ttdeci">static unsigned port</div><div class="ttdef"><b>Definition:</b> <a href="flowgrindd_8c_source.html#l00095">flowgrindd.c:95</a></div></div>
<div class="ttc" id="structfg__rpc__server_html_a7d67f166831ed00d0eefffe7e0fc1487"><div class="ttname"><a href="structfg__rpc__server.html#a7d67f166831ed00d0eefffe7e0fc1487">fg_rpc_server::parms</a></div><div class="ttdeci">xmlrpc_server_abyss_parms parms</div><div class="ttdoc">Parameters of the XMLrpc server. </div><div class="ttdef"><b>Definition:</b> <a href="fg__rpc__server_8h_source.html#l00054">fg_rpc_server.h:54</a></div></div>
<div class="ttc" id="fg__rpc__server_8c_html_a55fd54a0087dd0ac821433cbda1f65bd"><div class="ttname"><a href="fg__rpc__server_8c.html#a55fd54a0087dd0ac821433cbda1f65bd">add_flow_source</a></div><div class="ttdeci">static xmlrpc_value * add_flow_source(xmlrpc_env *const env, xmlrpc_value *const param_array, void *const user_data)</div><div class="ttdoc">Prepare data connection for source endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="fg__rpc__server_8c_source.html#l00062">fg_rpc_server.c:62</a></div></div>
<div class="ttc" id="fg__rpc__server_8c_html_a82089af015ac3c47e11de91d23ee09a3"><div class="ttname"><a href="fg__rpc__server_8c.html#a82089af015ac3c47e11de91d23ee09a3">method_get_status</a></div><div class="ttdeci">static xmlrpc_value * method_get_status(xmlrpc_env *const env, xmlrpc_value *const param_array, void *const user_data)</div><div class="ttdef"><b>Definition:</b> <a href="fg__rpc__server_8c_source.html#l00702">fg_rpc_server.c:702</a></div></div>
<div class="ttc" id="fg__rpc__server_8c_html_a0b6b9e3fdcd13d429b8a223e68a88477"><div class="ttname"><a href="fg__rpc__server_8c.html#a0b6b9e3fdcd13d429b8a223e68a88477">method_get_uuid</a></div><div class="ttdeci">static xmlrpc_value * method_get_uuid(xmlrpc_env *const env, xmlrpc_value *const param_array, void *const user_data)</div><div class="ttdoc">To get the daemons UUID. </div><div class="ttdef"><b>Definition:</b> <a href="fg__rpc__server_8c_source.html#l00752">fg_rpc_server.c:752</a></div></div>
<div class="ttc" id="fg__rpc__server_8c_html_aa474434b5dc6f7e1a4ca9af98382c37f"><div class="ttname"><a href="fg__rpc__server_8c.html#aa474434b5dc6f7e1a4ca9af98382c37f">start_flows</a></div><div class="ttdeci">static xmlrpc_value * start_flows(xmlrpc_env *const env, xmlrpc_value *const param_array, void *const user_data)</div><div class="ttdef"><b>Definition:</b> <a href="fg__rpc__server_8c_source.html#l00462">fg_rpc_server.c:462</a></div></div>
<div class="ttc" id="fg__rpc__server_8c_html_ae3418ca5436aaeb5b83c53ae80752329"><div class="ttname"><a href="fg__rpc__server_8c.html#ae3418ca5436aaeb5b83c53ae80752329">method_get_version</a></div><div class="ttdeci">static xmlrpc_value * method_get_version(xmlrpc_env *const env, xmlrpc_value *const param_array, void *const user_data)</div><div class="ttdef"><b>Definition:</b> <a href="fg__rpc__server_8c_source.html#l00669">fg_rpc_server.c:669</a></div></div>
<div class="ttc" id="fg__rpc__server_8c_html_ad1401628a7594a7835fcdfabefefd689"><div class="ttname"><a href="fg__rpc__server_8c.html#ad1401628a7594a7835fcdfabefefd689">add_flow_destination</a></div><div class="ttdeci">static xmlrpc_value * add_flow_destination(xmlrpc_env *const env, xmlrpc_value *const param_array, void *const user_data)</div><div class="ttdoc">Prepare data connection for destination endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="fg__rpc__server_8c_source.html#l00277">fg_rpc_server.c:277</a></div></div>
<div class="ttc" id="structfg__rpc__server_html_a8836ac2554cec646a01a160eab391d45"><div class="ttname"><a href="structfg__rpc__server.html#a8836ac2554cec646a01a160eab391d45">fg_rpc_server::env</a></div><div class="ttdeci">xmlrpc_env env</div><div class="ttdoc">Environment used by the Abyss server. </div><div class="ttdef"><b>Definition:</b> <a href="fg__rpc__server_8h_source.html#l00052">fg_rpc_server.h:52</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a704160b94299ac9000d1c48c41d866a5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static xmlrpc_value* method_get_reports </td>
          <td>(</td>
          <td class="paramtype">xmlrpc_env *const&#160;</td>
          <td class="paramname"><em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">xmlrpc_value *const&#160;</td>
          <td class="paramname"><em>param_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *const&#160;</td>
          <td class="paramname"><em>user_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>To get the reports from the daemon. </p>
<p>Flowgrind rpc server get the reports from the daemon and encode the information and send the report data to the controller through XML-RPC connection</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">env</td><td>XML-RPC environment object </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">param_array</td><td>unused arg </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user_data</td><td>unused arg return xmlrpc_value XML-RPC value </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="fg__rpc__server_8c_source.html#l00518">518</a> of file <a class="el" href="fg__rpc__server_8c_source.html">fg_rpc_server.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;{</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="keywordtype">int</span> has_more;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        xmlrpc_value *ret = 0, *item = 0;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <a class="code" href="fg__definitions_8h.html#a239dd5192fcd165ce89d2c6d08e34993">UNUSED_ARGUMENT</a>(param_array);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <a class="code" href="fg__definitions_8h.html#a239dd5192fcd165ce89d2c6d08e34993">UNUSED_ARGUMENT</a>(user_data);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_NOTICE, <span class="stringliteral">&quot;method get_reports called&quot;</span>);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="keyword">struct </span><a class="code" href="structreport.html">report</a> *<a class="code" href="structreport.html">report</a> = <a class="code" href="daemon_8c.html#ae1c880d68d8e730eaf7836e3883b6fbf">get_reports</a>(&amp;has_more);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        ret = xmlrpc_array_new(env);</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="comment">/* Add information if there&#39;s more reports pending */</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        item = xmlrpc_int_new(env, has_more);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        xmlrpc_array_append_item(env, ret, item);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        xmlrpc_DECREF(item);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="keywordflow">while</span> (report) {</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                xmlrpc_value *rv = xmlrpc_build_value(env,</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                        <span class="stringliteral">&quot;(&quot;</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                        <span class="stringliteral">&quot;{s:i,s:i,s:i,s:i,s:i,s:i,s:i}&quot;</span> <span class="comment">/* Report data &amp; timeval */</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                        <span class="stringliteral">&quot;{s:i,s:i,s:i,s:i}&quot;</span> <span class="comment">/* bytes */</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                        <span class="stringliteral">&quot;{s:i,s:i,s:i,s:i}&quot;</span> <span class="comment">/* block counts */</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                        <span class="stringliteral">&quot;{s:d,s:d,s:d,s:d,s:d,s:d,s:d,s:d,s:d}&quot;</span> <span class="comment">/* RTT, IAT, Delay */</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                        <span class="stringliteral">&quot;{s:i,s:i}&quot;</span> <span class="comment">/* MTU */</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                        <span class="stringliteral">&quot;{s:i,s:i,s:i,s:i,s:i}&quot;</span> <span class="comment">/* TCP info */</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                        <span class="stringliteral">&quot;{s:i,s:i,s:i,s:i,s:i}&quot;</span> <span class="comment">/* ...      */</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                        <span class="stringliteral">&quot;{s:i,s:i,s:i,s:i,s:i}&quot;</span> <span class="comment">/* ...      */</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                        <span class="stringliteral">&quot;{s:i}&quot;</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                        <span class="stringliteral">&quot;)&quot;</span>,</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                        <span class="stringliteral">&quot;id&quot;</span>, report-&gt;<a class="code" href="structreport.html#a545b6df40c29e489ba5fe507d80b9042">id</a>,</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                        <span class="stringliteral">&quot;endpoint&quot;</span>,report-&gt;<a class="code" href="structreport.html#af9a9df70cefb7cdb4d3906bc49409d23">endpoint</a>,</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                        <span class="stringliteral">&quot;type&quot;</span>, report-&gt;<a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a>,</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                        <span class="stringliteral">&quot;begin_tv_sec&quot;</span>, (<span class="keywordtype">int</span>)report-&gt;<a class="code" href="structreport.html#ae81ba92c32db53c978e9367ea9d0ebba">begin</a>.tv_sec,</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                        <span class="stringliteral">&quot;begin_tv_nsec&quot;</span>, (<span class="keywordtype">int</span>)report-&gt;<a class="code" href="structreport.html#ae81ba92c32db53c978e9367ea9d0ebba">begin</a>.tv_nsec,</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                        <span class="stringliteral">&quot;end_tv_sec&quot;</span>, (<span class="keywordtype">int</span>)report-&gt;<a class="code" href="structreport.html#a4cced7e0a3c15aa25a0b1a095ad3e78e">end</a>.tv_sec,</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                        <span class="stringliteral">&quot;end_tv_nsec&quot;</span>, (<span class="keywordtype">int</span>)report-&gt;<a class="code" href="structreport.html#a4cced7e0a3c15aa25a0b1a095ad3e78e">end</a>.tv_nsec,</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                        <span class="stringliteral">&quot;bytes_read_high&quot;</span>, (int32_t)(report-&gt;<a class="code" href="structreport.html#aef54fe7e2baef46bb8e00977474ba566">bytes_read</a> &gt;&gt; 32),</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                        <span class="stringliteral">&quot;bytes_read_low&quot;</span>, (int32_t)(report-&gt;<a class="code" href="structreport.html#aef54fe7e2baef46bb8e00977474ba566">bytes_read</a> &amp; 0xFFFFFFFF),</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                        <span class="stringliteral">&quot;bytes_written_high&quot;</span>, (int32_t)(report-&gt;<a class="code" href="structreport.html#a7330324173edbf9bb4f0efc9b7a534ab">bytes_written</a> &gt;&gt; 32),</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                        <span class="stringliteral">&quot;bytes_written_low&quot;</span>, (int32_t)(report-&gt;<a class="code" href="structreport.html#a7330324173edbf9bb4f0efc9b7a534ab">bytes_written</a> &amp; 0xFFFFFFFF),</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                        <span class="stringliteral">&quot;request_blocks_read&quot;</span>, report-&gt;<a class="code" href="structreport.html#a18e53a95141a93975bc72f68ca0a8cca">request_blocks_read</a>,</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                        <span class="stringliteral">&quot;request_blocks_written&quot;</span>, report-&gt;<a class="code" href="structreport.html#aec7214fb99ce49098845df88cbfd7a86">request_blocks_written</a>,</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                        <span class="stringliteral">&quot;response_blocks_read&quot;</span>, report-&gt;<a class="code" href="structreport.html#a1371323e38cf2d43f2b822ee23a5528c">response_blocks_read</a>,</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                        <span class="stringliteral">&quot;response_blocks_written&quot;</span>, report-&gt;<a class="code" href="structreport.html#a41799abc2e9f9df843fa4a62079de7d5">response_blocks_written</a>,</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                        <span class="stringliteral">&quot;rtt_min&quot;</span>, report-&gt;<a class="code" href="structreport.html#a431ccdbe065dbfc7e641ddb7cfb71bd3">rtt_min</a>,</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                        <span class="stringliteral">&quot;rtt_max&quot;</span>, report-&gt;<a class="code" href="structreport.html#a53022f1afe786c88882906d0f154fc72">rtt_max</a>,</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                        <span class="stringliteral">&quot;rtt_sum&quot;</span>, report-&gt;<a class="code" href="structreport.html#a73a129ba9326de2855f317b55245e4e5">rtt_sum</a>,</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                        <span class="stringliteral">&quot;iat_min&quot;</span>, report-&gt;<a class="code" href="structreport.html#a8e77e60d692703b2273e058e0f879c11">iat_min</a>,</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                        <span class="stringliteral">&quot;iat_max&quot;</span>, report-&gt;<a class="code" href="structreport.html#ab0b9886231083d13efdd5e0e01038cc3">iat_max</a>,</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                        <span class="stringliteral">&quot;iat_sum&quot;</span>, report-&gt;<a class="code" href="structreport.html#af9381bd31155ddb60adfd66b0ed26ef2">iat_sum</a>,</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                        <span class="stringliteral">&quot;delay_min&quot;</span>, report-&gt;<a class="code" href="structreport.html#a14340938e5747205d3833a5ae3d3b6c9">delay_min</a>,</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                        <span class="stringliteral">&quot;delay_max&quot;</span>, report-&gt;<a class="code" href="structreport.html#abdaec61f3f26be9d4361780367d73e3d">delay_max</a>,</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                        <span class="stringliteral">&quot;delay_sum&quot;</span>, report-&gt;<a class="code" href="structreport.html#a6868860ad81a10e0bb9d842cb930b0ab">delay_sum</a>,</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                        <span class="stringliteral">&quot;pmtu&quot;</span>, report-&gt;<a class="code" href="structreport.html#acbd4824b0e80be7694c7b7ec9e71166a">pmtu</a>,</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                        <span class="stringliteral">&quot;imtu&quot;</span>, report-&gt;<a class="code" href="structreport.html#a3a4dda0155ea81a8dcd03e17acd12c3d">imtu</a>,</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">/* Currently, not all members of the TCP_INFO socket option are used by the</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment"> * FreeBSD kernel. Other members will contain zeroes */</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                        <span class="stringliteral">&quot;tcpi_snd_cwnd&quot;</span>, (<span class="keywordtype">int</span>)report-&gt;<a class="code" href="structreport.html#a528c4587a08a4a415c7089932facd980">tcp_info</a>.<a class="code" href="structfg__tcp__info.html#ac11267c50156687f612e2116c95c4a44">tcpi_snd_cwnd</a>,</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                        <span class="stringliteral">&quot;tcpi_snd_ssthresh&quot;</span>, (<span class="keywordtype">int</span>)report-&gt;<a class="code" href="structreport.html#a528c4587a08a4a415c7089932facd980">tcp_info</a>.<a class="code" href="structfg__tcp__info.html#a2b22b6f56952b94931068174c6d90daa">tcpi_snd_ssthresh</a>,</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                        <span class="stringliteral">&quot;tcpi_unacked&quot;</span>, (<span class="keywordtype">int</span>)report-&gt;<a class="code" href="structreport.html#a528c4587a08a4a415c7089932facd980">tcp_info</a>.<a class="code" href="structfg__tcp__info.html#a52f75bc5cd437d60782f84d456de7931">tcpi_unacked</a>,</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                        <span class="stringliteral">&quot;tcpi_sacked&quot;</span>, (<span class="keywordtype">int</span>)report-&gt;<a class="code" href="structreport.html#a528c4587a08a4a415c7089932facd980">tcp_info</a>.<a class="code" href="structfg__tcp__info.html#ad7a39462839ef08916170b29723549f7">tcpi_sacked</a>,</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                        <span class="stringliteral">&quot;tcpi_lost&quot;</span>, (<span class="keywordtype">int</span>)report-&gt;<a class="code" href="structreport.html#a528c4587a08a4a415c7089932facd980">tcp_info</a>.<a class="code" href="structfg__tcp__info.html#af58fb54b2aff0d9fb2e967fbdc72a3a2">tcpi_lost</a>,</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                        <span class="stringliteral">&quot;tcpi_retrans&quot;</span>, (<span class="keywordtype">int</span>)report-&gt;<a class="code" href="structreport.html#a528c4587a08a4a415c7089932facd980">tcp_info</a>.<a class="code" href="structfg__tcp__info.html#adb09e4585befc31a3775e55377d40569">tcpi_retrans</a>,</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                        <span class="stringliteral">&quot;tcpi_retransmits&quot;</span>, (<span class="keywordtype">int</span>)report-&gt;<a class="code" href="structreport.html#a528c4587a08a4a415c7089932facd980">tcp_info</a>.<a class="code" href="structfg__tcp__info.html#a541c21fa61a0f6f1bd9c1e1e35c257be">tcpi_retransmits</a>,</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                        <span class="stringliteral">&quot;tcpi_fackets&quot;</span>, (<span class="keywordtype">int</span>)report-&gt;<a class="code" href="structreport.html#a528c4587a08a4a415c7089932facd980">tcp_info</a>.<a class="code" href="structfg__tcp__info.html#a6288c818b8fba26b1fea81de431b631f">tcpi_fackets</a>,</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                        <span class="stringliteral">&quot;tcpi_reordering&quot;</span>, (<span class="keywordtype">int</span>)report-&gt;<a class="code" href="structreport.html#a528c4587a08a4a415c7089932facd980">tcp_info</a>.<a class="code" href="structfg__tcp__info.html#ab0d8711904e82e3bc7f8c6383598cee1">tcpi_reordering</a>,</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                        <span class="stringliteral">&quot;tcpi_rtt&quot;</span>, (<span class="keywordtype">int</span>)report-&gt;<a class="code" href="structreport.html#a528c4587a08a4a415c7089932facd980">tcp_info</a>.<a class="code" href="structfg__tcp__info.html#ac02d505bda77a0cc14106cebef454055">tcpi_rtt</a>,</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                        <span class="stringliteral">&quot;tcpi_rttvar&quot;</span>, (<span class="keywordtype">int</span>)report-&gt;<a class="code" href="structreport.html#a528c4587a08a4a415c7089932facd980">tcp_info</a>.<a class="code" href="structfg__tcp__info.html#acf9ef825f18268ec1ffda8e7d5874f00">tcpi_rttvar</a>,</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                        <span class="stringliteral">&quot;tcpi_rto&quot;</span>, (<span class="keywordtype">int</span>)report-&gt;<a class="code" href="structreport.html#a528c4587a08a4a415c7089932facd980">tcp_info</a>.<a class="code" href="structfg__tcp__info.html#a5b1b3f36bfc6211de05f6ed6dda785ad">tcpi_rto</a>,</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                        <span class="stringliteral">&quot;tcpi_backoff&quot;</span>, (<span class="keywordtype">int</span>)report-&gt;<a class="code" href="structreport.html#a528c4587a08a4a415c7089932facd980">tcp_info</a>.<a class="code" href="structfg__tcp__info.html#a98adc6ad4917f8381344429d7fa6fa36">tcpi_backoff</a>,</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                        <span class="stringliteral">&quot;tcpi_ca_state&quot;</span>, (<span class="keywordtype">int</span>)report-&gt;<a class="code" href="structreport.html#a528c4587a08a4a415c7089932facd980">tcp_info</a>.<a class="code" href="structfg__tcp__info.html#a6afcefb10dd2f6ae579dfc10005ec7f1">tcpi_ca_state</a>,</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                        <span class="stringliteral">&quot;tcpi_snd_mss&quot;</span>, (<span class="keywordtype">int</span>)report-&gt;<a class="code" href="structreport.html#a528c4587a08a4a415c7089932facd980">tcp_info</a>.<a class="code" href="structfg__tcp__info.html#aafc809e68bf6db2f46a4b329f2a45da8">tcpi_snd_mss</a>,</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                        <span class="stringliteral">&quot;status&quot;</span>, report-&gt;<a class="code" href="structreport.html#ac70e6c6ed639f5d93f9391e33e29a44f">status</a></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                );</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                xmlrpc_array_append_item(env, ret, rv);</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                xmlrpc_DECREF(rv);</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                <span class="keyword">struct </span>report *<a class="code" href="structreport.html#a0a3773754225984337b3363320143e6e">next</a> = report-&gt;<a class="code" href="structreport.html#a0a3773754225984337b3363320143e6e">next</a>;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                free(report);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                report = <a class="code" href="structreport.html#a0a3773754225984337b3363320143e6e">next</a>;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        }</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="keywordflow">if</span> (env-&gt;fault_occurred)</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                <a class="code" href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a>(LOG_WARNING, <span class="stringliteral">&quot;method get_reports failed: %s&quot;</span>,</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                        env-&gt;fault_string);</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_WARNING, <span class="stringliteral">&quot;method get_reports successful&quot;</span>);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;}</div><div class="ttc" id="structreport_html_a6868860ad81a10e0bb9d842cb930b0ab"><div class="ttname"><a href="structreport.html#a6868860ad81a10e0bb9d842cb930b0ab">report::delay_sum</a></div><div class="ttdeci">double delay_sum</div><div class="ttdoc">Accumulated one-way delay. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00319">common.h:319</a></div></div>
<div class="ttc" id="structreport_html_af9a9df70cefb7cdb4d3906bc49409d23"><div class="ttname"><a href="structreport.html#af9a9df70cefb7cdb4d3906bc49409d23">report::endpoint</a></div><div class="ttdeci">enum endpoint_t endpoint</div><div class="ttdoc">Daemon endpoint - either source or destination. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00289">common.h:289</a></div></div>
<div class="ttc" id="structreport_html_af9381bd31155ddb60adfd66b0ed26ef2"><div class="ttname"><a href="structreport.html#af9381bd31155ddb60adfd66b0ed26ef2">report::iat_sum</a></div><div class="ttdeci">double iat_sum</div><div class="ttdoc">Accumulated inter-arrival time. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00313">common.h:313</a></div></div>
<div class="ttc" id="fg__log_8c_html_a2aea54bb4eab90a69510db34326d82f4"><div class="ttname"><a href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a></div><div class="ttdeci">void logging(int priority, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="fg__log_8c_source.html#l00069">fg_log.c:69</a></div></div>
<div class="ttc" id="structfg__tcp__info_html_acf9ef825f18268ec1ffda8e7d5874f00"><div class="ttname"><a href="structfg__tcp__info.html#acf9ef825f18268ec1ffda8e7d5874f00">fg_tcp_info::tcpi_rttvar</a></div><div class="ttdeci">int tcpi_rttvar</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00278">common.h:278</a></div></div>
<div class="ttc" id="structreport_html_ae81ba92c32db53c978e9367ea9d0ebba"><div class="ttname"><a href="structreport.html#ae81ba92c32db53c978e9367ea9d0ebba">report::begin</a></div><div class="ttdeci">struct timespec begin</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00292">common.h:292</a></div></div>
<div class="ttc" id="structreport_html_a0a3773754225984337b3363320143e6e"><div class="ttname"><a href="structreport.html#a0a3773754225984337b3363320143e6e">report::next</a></div><div class="ttdeci">struct report * next</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00338">common.h:338</a></div></div>
<div class="ttc" id="structreport_html_a73a129ba9326de2855f317b55245e4e5"><div class="ttname"><a href="structreport.html#a73a129ba9326de2855f317b55245e4e5">report::rtt_sum</a></div><div class="ttdeci">double rtt_sum</div><div class="ttdoc">Accumulated round-trip time. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00325">common.h:325</a></div></div>
<div class="ttc" id="structfg__tcp__info_html_aafc809e68bf6db2f46a4b329f2a45da8"><div class="ttname"><a href="structfg__tcp__info.html#aafc809e68bf6db2f46a4b329f2a45da8">fg_tcp_info::tcpi_snd_mss</a></div><div class="ttdeci">int tcpi_snd_mss</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00281">common.h:281</a></div></div>
<div class="ttc" id="structreport_html_a4cced7e0a3c15aa25a0b1a095ad3e78e"><div class="ttname"><a href="structreport.html#a4cced7e0a3c15aa25a0b1a095ad3e78e">report::end</a></div><div class="ttdeci">struct timespec end</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00293">common.h:293</a></div></div>
<div class="ttc" id="structreport_html_a431ccdbe065dbfc7e641ddb7cfb71bd3"><div class="ttname"><a href="structreport.html#a431ccdbe065dbfc7e641ddb7cfb71bd3">report::rtt_min</a></div><div class="ttdeci">double rtt_min</div><div class="ttdoc">Minimum round-trip time. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00321">common.h:321</a></div></div>
<div class="ttc" id="structreport_html_a545b6df40c29e489ba5fe507d80b9042"><div class="ttname"><a href="structreport.html#a545b6df40c29e489ba5fe507d80b9042">report::id</a></div><div class="ttdeci">int id</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00287">common.h:287</a></div></div>
<div class="ttc" id="structreport_html_a18e53a95141a93975bc72f68ca0a8cca"><div class="ttname"><a href="structreport.html#a18e53a95141a93975bc72f68ca0a8cca">report::request_blocks_read</a></div><div class="ttdeci">unsigned request_blocks_read</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00301">common.h:301</a></div></div>
<div class="ttc" id="structreport_html_a8e77e60d692703b2273e058e0f879c11"><div class="ttname"><a href="structreport.html#a8e77e60d692703b2273e058e0f879c11">report::iat_min</a></div><div class="ttdeci">double iat_min</div><div class="ttdoc">Minimum inter-arrival time. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00309">common.h:309</a></div></div>
<div class="ttc" id="structfg__tcp__info_html_a52f75bc5cd437d60782f84d456de7931"><div class="ttname"><a href="structfg__tcp__info.html#a52f75bc5cd437d60782f84d456de7931">fg_tcp_info::tcpi_unacked</a></div><div class="ttdeci">int tcpi_unacked</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00270">common.h:270</a></div></div>
<div class="ttc" id="structfg__tcp__info_html_a541c21fa61a0f6f1bd9c1e1e35c257be"><div class="ttname"><a href="structfg__tcp__info.html#a541c21fa61a0f6f1bd9c1e1e35c257be">fg_tcp_info::tcpi_retransmits</a></div><div class="ttdeci">int tcpi_retransmits</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00274">common.h:274</a></div></div>
<div class="ttc" id="structreport_html"><div class="ttname"><a href="structreport.html">report</a></div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00286">common.h:286</a></div></div>
<div class="ttc" id="structfg__tcp__info_html_a6288c818b8fba26b1fea81de431b631f"><div class="ttname"><a href="structfg__tcp__info.html#a6288c818b8fba26b1fea81de431b631f">fg_tcp_info::tcpi_fackets</a></div><div class="ttdeci">int tcpi_fackets</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00275">common.h:275</a></div></div>
<div class="ttc" id="structreport_html_a41799abc2e9f9df843fa4a62079de7d5"><div class="ttname"><a href="structreport.html#a41799abc2e9f9df843fa4a62079de7d5">report::response_blocks_written</a></div><div class="ttdeci">unsigned response_blocks_written</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00304">common.h:304</a></div></div>
<div class="ttc" id="structreport_html_a528c4587a08a4a415c7089932facd980"><div class="ttname"><a href="structreport.html#a528c4587a08a4a415c7089932facd980">report::tcp_info</a></div><div class="ttdeci">struct fg_tcp_info tcp_info</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00329">common.h:329</a></div></div>
<div class="ttc" id="structreport_html_acbd4824b0e80be7694c7b7ec9e71166a"><div class="ttname"><a href="structreport.html#acbd4824b0e80be7694c7b7ec9e71166a">report::pmtu</a></div><div class="ttdeci">unsigned pmtu</div><div class="ttdoc">Discovered Path MTU. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00332">common.h:332</a></div></div>
<div class="ttc" id="structfg__tcp__info_html_a5b1b3f36bfc6211de05f6ed6dda785ad"><div class="ttname"><a href="structfg__tcp__info.html#a5b1b3f36bfc6211de05f6ed6dda785ad">fg_tcp_info::tcpi_rto</a></div><div class="ttdeci">int tcpi_rto</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00279">common.h:279</a></div></div>
<div class="ttc" id="debug_8h_html_ae420d5a1d63f99c6a2a386c4eea54250"><div class="ttname"><a href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a></div><div class="ttdeci">#define DEBUG_MSG(LVL, MSG,...)</div><div class="ttdoc">Print debug message to standard error. </div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00049">debug.h:49</a></div></div>
<div class="ttc" id="structreport_html_a3a4dda0155ea81a8dcd03e17acd12c3d"><div class="ttname"><a href="structreport.html#a3a4dda0155ea81a8dcd03e17acd12c3d">report::imtu</a></div><div class="ttdeci">unsigned imtu</div><div class="ttdoc">Interface MTU. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00334">common.h:334</a></div></div>
<div class="ttc" id="structreport_html_ac70e6c6ed639f5d93f9391e33e29a44f"><div class="ttname"><a href="structreport.html#ac70e6c6ed639f5d93f9391e33e29a44f">report::status</a></div><div class="ttdeci">int status</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00336">common.h:336</a></div></div>
<div class="ttc" id="structreport_html_a53022f1afe786c88882906d0f154fc72"><div class="ttname"><a href="structreport.html#a53022f1afe786c88882906d0f154fc72">report::rtt_max</a></div><div class="ttdeci">double rtt_max</div><div class="ttdoc">Maximum round-trip time. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00323">common.h:323</a></div></div>
<div class="ttc" id="daemon_8c_html_ae1c880d68d8e730eaf7836e3883b6fbf"><div class="ttname"><a href="daemon_8c.html#ae1c880d68d8e730eaf7836e3883b6fbf">get_reports</a></div><div class="ttdeci">struct report * get_reports(int *has_more)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00849">daemon.c:849</a></div></div>
<div class="ttc" id="structfg__tcp__info_html_ac11267c50156687f612e2116c95c4a44"><div class="ttname"><a href="structfg__tcp__info.html#ac11267c50156687f612e2116c95c4a44">fg_tcp_info::tcpi_snd_cwnd</a></div><div class="ttdeci">int tcpi_snd_cwnd</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00268">common.h:268</a></div></div>
<div class="ttc" id="fg__definitions_8h_html_a239dd5192fcd165ce89d2c6d08e34993"><div class="ttname"><a href="fg__definitions_8h.html#a239dd5192fcd165ce89d2c6d08e34993">UNUSED_ARGUMENT</a></div><div class="ttdeci">#define UNUSED_ARGUMENT(x)</div><div class="ttdoc">Suppress warning for unused argument. </div><div class="ttdef"><b>Definition:</b> <a href="fg__definitions_8h_source.html#l00038">fg_definitions.h:38</a></div></div>
<div class="ttc" id="structreport_html_aec7214fb99ce49098845df88cbfd7a86"><div class="ttname"><a href="structreport.html#aec7214fb99ce49098845df88cbfd7a86">report::request_blocks_written</a></div><div class="ttdeci">unsigned request_blocks_written</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00302">common.h:302</a></div></div>
<div class="ttc" id="structreport_html_ad501f3629fd9df5887dde4de44d02f45"><div class="ttname"><a href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">report::type</a></div><div class="ttdeci">enum report_t type</div><div class="ttdoc">Report type - either INTERVAL or FINAL report. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00291">common.h:291</a></div></div>
<div class="ttc" id="structreport_html_a1371323e38cf2d43f2b822ee23a5528c"><div class="ttname"><a href="structreport.html#a1371323e38cf2d43f2b822ee23a5528c">report::response_blocks_read</a></div><div class="ttdeci">unsigned response_blocks_read</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00303">common.h:303</a></div></div>
<div class="ttc" id="structreport_html_a14340938e5747205d3833a5ae3d3b6c9"><div class="ttname"><a href="structreport.html#a14340938e5747205d3833a5ae3d3b6c9">report::delay_min</a></div><div class="ttdeci">double delay_min</div><div class="ttdoc">Minimum one-way delay. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00315">common.h:315</a></div></div>
<div class="ttc" id="structfg__tcp__info_html_a2b22b6f56952b94931068174c6d90daa"><div class="ttname"><a href="structfg__tcp__info.html#a2b22b6f56952b94931068174c6d90daa">fg_tcp_info::tcpi_snd_ssthresh</a></div><div class="ttdeci">int tcpi_snd_ssthresh</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00269">common.h:269</a></div></div>
<div class="ttc" id="structfg__tcp__info_html_a6afcefb10dd2f6ae579dfc10005ec7f1"><div class="ttname"><a href="structfg__tcp__info.html#a6afcefb10dd2f6ae579dfc10005ec7f1">fg_tcp_info::tcpi_ca_state</a></div><div class="ttdeci">int tcpi_ca_state</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00282">common.h:282</a></div></div>
<div class="ttc" id="structfg__tcp__info_html_adb09e4585befc31a3775e55377d40569"><div class="ttname"><a href="structfg__tcp__info.html#adb09e4585befc31a3775e55377d40569">fg_tcp_info::tcpi_retrans</a></div><div class="ttdeci">int tcpi_retrans</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00273">common.h:273</a></div></div>
<div class="ttc" id="structreport_html_a7330324173edbf9bb4f0efc9b7a534ab"><div class="ttname"><a href="structreport.html#a7330324173edbf9bb4f0efc9b7a534ab">report::bytes_written</a></div><div class="ttdeci">unsigned long long bytes_written</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00296">common.h:296</a></div></div>
<div class="ttc" id="structreport_html_ab0b9886231083d13efdd5e0e01038cc3"><div class="ttname"><a href="structreport.html#ab0b9886231083d13efdd5e0e01038cc3">report::iat_max</a></div><div class="ttdeci">double iat_max</div><div class="ttdoc">Maximum inter-arrival time. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00311">common.h:311</a></div></div>
<div class="ttc" id="structreport_html_abdaec61f3f26be9d4361780367d73e3d"><div class="ttname"><a href="structreport.html#abdaec61f3f26be9d4361780367d73e3d">report::delay_max</a></div><div class="ttdeci">double delay_max</div><div class="ttdoc">Maximum one-way delay. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00317">common.h:317</a></div></div>
<div class="ttc" id="structreport_html_aef54fe7e2baef46bb8e00977474ba566"><div class="ttname"><a href="structreport.html#aef54fe7e2baef46bb8e00977474ba566">report::bytes_read</a></div><div class="ttdeci">unsigned long long bytes_read</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00295">common.h:295</a></div></div>
<div class="ttc" id="structfg__tcp__info_html_af58fb54b2aff0d9fb2e967fbdc72a3a2"><div class="ttname"><a href="structfg__tcp__info.html#af58fb54b2aff0d9fb2e967fbdc72a3a2">fg_tcp_info::tcpi_lost</a></div><div class="ttdeci">int tcpi_lost</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00272">common.h:272</a></div></div>
<div class="ttc" id="structfg__tcp__info_html_ab0d8711904e82e3bc7f8c6383598cee1"><div class="ttname"><a href="structfg__tcp__info.html#ab0d8711904e82e3bc7f8c6383598cee1">fg_tcp_info::tcpi_reordering</a></div><div class="ttdeci">int tcpi_reordering</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00276">common.h:276</a></div></div>
<div class="ttc" id="structfg__tcp__info_html_a98adc6ad4917f8381344429d7fa6fa36"><div class="ttname"><a href="structfg__tcp__info.html#a98adc6ad4917f8381344429d7fa6fa36">fg_tcp_info::tcpi_backoff</a></div><div class="ttdeci">int tcpi_backoff</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00280">common.h:280</a></div></div>
<div class="ttc" id="structfg__tcp__info_html_ad7a39462839ef08916170b29723549f7"><div class="ttname"><a href="structfg__tcp__info.html#ad7a39462839ef08916170b29723549f7">fg_tcp_info::tcpi_sacked</a></div><div class="ttdeci">int tcpi_sacked</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00271">common.h:271</a></div></div>
<div class="ttc" id="structfg__tcp__info_html_ac02d505bda77a0cc14106cebef454055"><div class="ttname"><a href="structfg__tcp__info.html#ac02d505bda77a0cc14106cebef454055">fg_tcp_info::tcpi_rtt</a></div><div class="ttdeci">int tcpi_rtt</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00277">common.h:277</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a82089af015ac3c47e11de91d23ee09a3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static xmlrpc_value* method_get_status </td>
          <td>(</td>
          <td class="paramtype">xmlrpc_env *const&#160;</td>
          <td class="paramname"><em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">xmlrpc_value *const&#160;</td>
          <td class="paramname"><em>param_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *const&#160;</td>
          <td class="paramname"><em>user_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="fg__rpc__server_8c_source.html#l00702">702</a> of file <a class="el" href="fg__rpc__server_8c_source.html">fg_rpc_server.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;{</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <a class="code" href="fg__definitions_8h.html#a239dd5192fcd165ce89d2c6d08e34993">UNUSED_ARGUMENT</a>(param_array);</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <a class="code" href="fg__definitions_8h.html#a239dd5192fcd165ce89d2c6d08e34993">UNUSED_ARGUMENT</a>(user_data);</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        <span class="keywordtype">int</span> rc;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        xmlrpc_value *ret = 0;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="keyword">struct </span><a class="code" href="structrequest__get__status.html">request_get_status</a> *<a class="code" href="structrequest.html">request</a> = 0;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_WARNING, <span class="stringliteral">&quot;method get_status called&quot;</span>);</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        request = malloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrequest__get__status.html">request_get_status</a>));</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        rc = <a class="code" href="daemon_8c.html#a4271388fd018c3d910e4839b3747df96">dispatch_request</a>((<span class="keyword">struct</span> request*)request, <a class="code" href="daemon_8h.html#a98e181f48db2db4c7cbf28cde6f9232a">REQUEST_GET_STATUS</a>);</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        <span class="keywordflow">if</span> (rc == -1)</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                XMLRPC_FAIL(env, XMLRPC_INTERNAL_ERROR, request-&gt;<a class="code" href="structrequest__get__status.html#abff36def99e64c89154a718058b1226c">r</a>.<a class="code" href="structrequest.html#acc214191f4fbfabdedf789adc862b393">error</a>); <span class="comment">/* goto cleanup on failure */</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="comment">/* Return our result. */</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        ret = xmlrpc_build_value(env, <span class="stringliteral">&quot;{s:i,s:i}&quot;</span>,</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                <span class="stringliteral">&quot;started&quot;</span>, request-&gt;<a class="code" href="structrequest__get__status.html#a5eb3d3d111e17c1bd1909072463bed05">started</a>,</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                <span class="stringliteral">&quot;num_flows&quot;</span>, request-&gt;<a class="code" href="structrequest__get__status.html#aa230b6089351175df9b59e835b56ccc4">num_flows</a>);</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;cleanup:</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keywordflow">if</span> (request)</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                <a class="code" href="fg__definitions_8h.html#a9735559a214ac1d8d9f8ceddfaeca672">free_all</a>(request-&gt;<a class="code" href="structrequest__get__status.html#abff36def99e64c89154a718058b1226c">r</a>.<a class="code" href="structrequest.html#acc214191f4fbfabdedf789adc862b393">error</a>, request);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        <span class="keywordflow">if</span> (env-&gt;fault_occurred)</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                <a class="code" href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a>(LOG_WARNING, <span class="stringliteral">&quot;method get_status failed: %s&quot;</span>,</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                        env-&gt;fault_string);</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_WARNING, <span class="stringliteral">&quot;method get_status successful&quot;</span>);</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;}</div><div class="ttc" id="structrequest__get__status_html_a5eb3d3d111e17c1bd1909072463bed05"><div class="ttname"><a href="structrequest__get__status.html#a5eb3d3d111e17c1bd1909072463bed05">request_get_status::started</a></div><div class="ttdeci">int started</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00251">daemon.h:251</a></div></div>
<div class="ttc" id="fg__log_8c_html_a2aea54bb4eab90a69510db34326d82f4"><div class="ttname"><a href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a></div><div class="ttdeci">void logging(int priority, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="fg__log_8c_source.html#l00069">fg_log.c:69</a></div></div>
<div class="ttc" id="daemon_8c_html_a4271388fd018c3d910e4839b3747df96"><div class="ttname"><a href="daemon_8c.html#a4271388fd018c3d910e4839b3747df96">dispatch_request</a></div><div class="ttdeci">int dispatch_request(struct request *request, int type)</div><div class="ttdoc">Dispatch a request to daemon loop. </div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l01485">daemon.c:1485</a></div></div>
<div class="ttc" id="debug_8h_html_ae420d5a1d63f99c6a2a386c4eea54250"><div class="ttname"><a href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a></div><div class="ttdeci">#define DEBUG_MSG(LVL, MSG,...)</div><div class="ttdoc">Print debug message to standard error. </div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00049">debug.h:49</a></div></div>
<div class="ttc" id="structrequest_html_acc214191f4fbfabdedf789adc862b393"><div class="ttname"><a href="structrequest.html#acc214191f4fbfabdedf789adc862b393">request::error</a></div><div class="ttdeci">char * error</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00187">daemon.h:187</a></div></div>
<div class="ttc" id="fg__definitions_8h_html_a239dd5192fcd165ce89d2c6d08e34993"><div class="ttname"><a href="fg__definitions_8h.html#a239dd5192fcd165ce89d2c6d08e34993">UNUSED_ARGUMENT</a></div><div class="ttdeci">#define UNUSED_ARGUMENT(x)</div><div class="ttdoc">Suppress warning for unused argument. </div><div class="ttdef"><b>Definition:</b> <a href="fg__definitions_8h_source.html#l00038">fg_definitions.h:38</a></div></div>
<div class="ttc" id="fg__definitions_8h_html_a9735559a214ac1d8d9f8ceddfaeca672"><div class="ttname"><a href="fg__definitions_8h.html#a9735559a214ac1d8d9f8ceddfaeca672">free_all</a></div><div class="ttdeci">#define free_all(...)</div><div class="ttdoc">To free() an arbitrary number of variables. </div><div class="ttdef"><b>Definition:</b> <a href="fg__definitions_8h_source.html#l00059">fg_definitions.h:59</a></div></div>
<div class="ttc" id="structrequest__get__status_html_aa230b6089351175df9b59e835b56ccc4"><div class="ttname"><a href="structrequest__get__status.html#aa230b6089351175df9b59e835b56ccc4">request_get_status::num_flows</a></div><div class="ttdeci">int num_flows</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00252">daemon.h:252</a></div></div>
<div class="ttc" id="structrequest_html"><div class="ttname"><a href="structrequest.html">request</a></div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00179">daemon.h:179</a></div></div>
<div class="ttc" id="daemon_8h_html_a98e181f48db2db4c7cbf28cde6f9232a"><div class="ttname"><a href="daemon_8h.html#a98e181f48db2db4c7cbf28cde6f9232a">REQUEST_GET_STATUS</a></div><div class="ttdeci">#define REQUEST_GET_STATUS</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00177">daemon.h:177</a></div></div>
<div class="ttc" id="structrequest__get__status_html"><div class="ttname"><a href="structrequest__get__status.html">request_get_status</a></div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00247">daemon.h:247</a></div></div>
<div class="ttc" id="structrequest__get__status_html_abff36def99e64c89154a718058b1226c"><div class="ttname"><a href="structrequest__get__status.html#abff36def99e64c89154a718058b1226c">request_get_status::r</a></div><div class="ttdeci">struct request r</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00249">daemon.h:249</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0b6b9e3fdcd13d429b8a223e68a88477"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static xmlrpc_value* method_get_uuid </td>
          <td>(</td>
          <td class="paramtype">xmlrpc_env *const&#160;</td>
          <td class="paramname"><em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">xmlrpc_value *const&#160;</td>
          <td class="paramname"><em>param_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *const&#160;</td>
          <td class="paramname"><em>user_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>To get the daemons UUID. </p>
<p>Flowgrind rpc server dispatch the request to get the daemon UUID based on the randomness. After getting these information flowgrind rpc server encode the information and send back the details to the controller through the XML-RPC connection.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">env</td><td>XML-RPC environment object </td></tr>
    <tr><td class="paramdir"></td><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="fg__rpc__server_8c_source.html#l00752">752</a> of file <a class="el" href="fg__rpc__server_8c_source.html">fg_rpc_server.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;{</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <a class="code" href="fg__definitions_8h.html#a239dd5192fcd165ce89d2c6d08e34993">UNUSED_ARGUMENT</a>(param_array);</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        <a class="code" href="fg__definitions_8h.html#a239dd5192fcd165ce89d2c6d08e34993">UNUSED_ARGUMENT</a>(user_data);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_WARNING, <span class="stringliteral">&quot;Method get_uuid called&quot;</span>);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        xmlrpc_value *ret = 0;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        <span class="keyword">struct </span><a class="code" href="structrequest__get__uuid.html">request_get_uuid</a> *<a class="code" href="structrequest.html">request</a> = malloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrequest__get__uuid.html">request_get_uuid</a>));</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <span class="keywordtype">int</span> rc = <a class="code" href="daemon_8c.html#a4271388fd018c3d910e4839b3747df96">dispatch_request</a>((<span class="keyword">struct</span> request*)request, <a class="code" href="daemon_8h.html#a7956881b57fbb4cf42cb60ce602c8313">REQUEST_GET_UUID</a>);</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <span class="keywordflow">if</span> (rc == -1)</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                XMLRPC_FAIL(env, XMLRPC_INTERNAL_ERROR, request-&gt;<a class="code" href="structrequest__get__uuid.html#a7738b09b8e9ab801adc04835cb573a3c">r</a>.<a class="code" href="structrequest.html#acc214191f4fbfabdedf789adc862b393">error</a>); <span class="comment">/* goto cleanup on failure */</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <span class="comment">/* Return our result. */</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        ret = xmlrpc_build_value(env, <span class="stringliteral">&quot;{s:s}&quot;</span>, <span class="stringliteral">&quot;server_uuid&quot;</span>, request-&gt;<a class="code" href="structrequest__get__uuid.html#a5a97b40f6c26dcdd6f76a797daca2e97">server_uuid</a>);</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;cleanup:</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="keywordflow">if</span> (request)</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                <a class="code" href="fg__definitions_8h.html#a9735559a214ac1d8d9f8ceddfaeca672">free_all</a>(request-&gt;<a class="code" href="structrequest__get__uuid.html#a7738b09b8e9ab801adc04835cb573a3c">r</a>.<a class="code" href="structrequest.html#acc214191f4fbfabdedf789adc862b393">error</a>, request);</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        <span class="keywordflow">if</span> (env-&gt;fault_occurred)</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                <a class="code" href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a>(LOG_WARNING, <span class="stringliteral">&quot;Method get_uuid failed: %s&quot;</span>, env-&gt;fault_string);</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_WARNING, <span class="stringliteral">&quot;Method get_uuid successful&quot;</span>);</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;}</div><div class="ttc" id="structrequest__get__uuid_html"><div class="ttname"><a href="structrequest__get__uuid.html">request_get_uuid</a></div><div class="ttdoc">structure for getting the UUID. </div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00240">daemon.h:240</a></div></div>
<div class="ttc" id="fg__log_8c_html_a2aea54bb4eab90a69510db34326d82f4"><div class="ttname"><a href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a></div><div class="ttdeci">void logging(int priority, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="fg__log_8c_source.html#l00069">fg_log.c:69</a></div></div>
<div class="ttc" id="daemon_8c_html_a4271388fd018c3d910e4839b3747df96"><div class="ttname"><a href="daemon_8c.html#a4271388fd018c3d910e4839b3747df96">dispatch_request</a></div><div class="ttdeci">int dispatch_request(struct request *request, int type)</div><div class="ttdoc">Dispatch a request to daemon loop. </div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l01485">daemon.c:1485</a></div></div>
<div class="ttc" id="debug_8h_html_ae420d5a1d63f99c6a2a386c4eea54250"><div class="ttname"><a href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a></div><div class="ttdeci">#define DEBUG_MSG(LVL, MSG,...)</div><div class="ttdoc">Print debug message to standard error. </div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00049">debug.h:49</a></div></div>
<div class="ttc" id="structrequest_html_acc214191f4fbfabdedf789adc862b393"><div class="ttname"><a href="structrequest.html#acc214191f4fbfabdedf789adc862b393">request::error</a></div><div class="ttdeci">char * error</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00187">daemon.h:187</a></div></div>
<div class="ttc" id="fg__definitions_8h_html_a239dd5192fcd165ce89d2c6d08e34993"><div class="ttname"><a href="fg__definitions_8h.html#a239dd5192fcd165ce89d2c6d08e34993">UNUSED_ARGUMENT</a></div><div class="ttdeci">#define UNUSED_ARGUMENT(x)</div><div class="ttdoc">Suppress warning for unused argument. </div><div class="ttdef"><b>Definition:</b> <a href="fg__definitions_8h_source.html#l00038">fg_definitions.h:38</a></div></div>
<div class="ttc" id="fg__definitions_8h_html_a9735559a214ac1d8d9f8ceddfaeca672"><div class="ttname"><a href="fg__definitions_8h.html#a9735559a214ac1d8d9f8ceddfaeca672">free_all</a></div><div class="ttdeci">#define free_all(...)</div><div class="ttdoc">To free() an arbitrary number of variables. </div><div class="ttdef"><b>Definition:</b> <a href="fg__definitions_8h_source.html#l00059">fg_definitions.h:59</a></div></div>
<div class="ttc" id="daemon_8h_html_a7956881b57fbb4cf42cb60ce602c8313"><div class="ttname"><a href="daemon_8h.html#a7956881b57fbb4cf42cb60ce602c8313">REQUEST_GET_UUID</a></div><div class="ttdeci">#define REQUEST_GET_UUID</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00178">daemon.h:178</a></div></div>
<div class="ttc" id="structrequest__get__uuid_html_a5a97b40f6c26dcdd6f76a797daca2e97"><div class="ttname"><a href="structrequest__get__uuid.html#a5a97b40f6c26dcdd6f76a797daca2e97">request_get_uuid::server_uuid</a></div><div class="ttdeci">char server_uuid[38]</div><div class="ttdoc">UUID from the daemon. </div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00244">daemon.h:244</a></div></div>
<div class="ttc" id="structrequest_html"><div class="ttname"><a href="structrequest.html">request</a></div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00179">daemon.h:179</a></div></div>
<div class="ttc" id="structrequest__get__uuid_html_a7738b09b8e9ab801adc04835cb573a3c"><div class="ttname"><a href="structrequest__get__uuid.html#a7738b09b8e9ab801adc04835cb573a3c">request_get_uuid::r</a></div><div class="ttdeci">struct request r</div><div class="ttdoc">Daemon thread process the request r. </div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00242">daemon.h:242</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae3418ca5436aaeb5b83c53ae80752329"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static xmlrpc_value* method_get_version </td>
          <td>(</td>
          <td class="paramtype">xmlrpc_env *const&#160;</td>
          <td class="paramname"><em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">xmlrpc_value *const&#160;</td>
          <td class="paramname"><em>param_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *const&#160;</td>
          <td class="paramname"><em>user_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="fg__rpc__server_8c_source.html#l00669">669</a> of file <a class="el" href="fg__rpc__server_8c_source.html">fg_rpc_server.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;{</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <a class="code" href="fg__definitions_8h.html#a239dd5192fcd165ce89d2c6d08e34993">UNUSED_ARGUMENT</a>(param_array);</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <a class="code" href="fg__definitions_8h.html#a239dd5192fcd165ce89d2c6d08e34993">UNUSED_ARGUMENT</a>(user_data);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <span class="keyword">struct </span>utsname buf;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        xmlrpc_value *ret = 0;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_WARNING, <span class="stringliteral">&quot;method get_version called&quot;</span>);</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <span class="keywordflow">if</span> (uname(&amp;buf)) {</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                <a class="code" href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a>(LOG_WARNING, <span class="stringliteral">&quot;uname() failed %s&quot;</span>, strerror(errno));</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                exit(1);</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        }</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        ret = xmlrpc_build_value(env, <span class="stringliteral">&quot;{s:s,s:i,s:s,s:s}&quot;</span>,</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                                 <span class="stringliteral">&quot;version&quot;</span>, <a class="code" href="common_8h.html#a67e3a5e6d1b103bd615c5de411177239">FLOWGRIND_VERSION</a>,</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                                 <span class="stringliteral">&quot;api_version&quot;</span>, <a class="code" href="common_8h.html#a6b7e8ee207cf41b6d54ec8ba365d2535">FLOWGRIND_API_VERSION</a>,</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                                 <span class="stringliteral">&quot;os_name&quot;</span>, buf.sysname,</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                                 <span class="stringliteral">&quot;os_release&quot;</span>, buf.release);</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <span class="keywordflow">if</span> (env-&gt;fault_occurred)</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                <a class="code" href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a>(LOG_WARNING, <span class="stringliteral">&quot;method get_version failed: %s&quot;</span>,</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                        env-&gt;fault_string);</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_WARNING, <span class="stringliteral">&quot;method get_version successful&quot;</span>);</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;}</div><div class="ttc" id="fg__log_8c_html_a2aea54bb4eab90a69510db34326d82f4"><div class="ttname"><a href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a></div><div class="ttdeci">void logging(int priority, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="fg__log_8c_source.html#l00069">fg_log.c:69</a></div></div>
<div class="ttc" id="debug_8h_html_ae420d5a1d63f99c6a2a386c4eea54250"><div class="ttname"><a href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a></div><div class="ttdeci">#define DEBUG_MSG(LVL, MSG,...)</div><div class="ttdoc">Print debug message to standard error. </div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00049">debug.h:49</a></div></div>
<div class="ttc" id="fg__definitions_8h_html_a239dd5192fcd165ce89d2c6d08e34993"><div class="ttname"><a href="fg__definitions_8h.html#a239dd5192fcd165ce89d2c6d08e34993">UNUSED_ARGUMENT</a></div><div class="ttdeci">#define UNUSED_ARGUMENT(x)</div><div class="ttdoc">Suppress warning for unused argument. </div><div class="ttdef"><b>Definition:</b> <a href="fg__definitions_8h_source.html#l00038">fg_definitions.h:38</a></div></div>
<div class="ttc" id="common_8h_html_a6b7e8ee207cf41b6d54ec8ba365d2535"><div class="ttname"><a href="common_8h.html#a6b7e8ee207cf41b6d54ec8ba365d2535">FLOWGRIND_API_VERSION</a></div><div class="ttdeci">#define FLOWGRIND_API_VERSION</div><div class="ttdoc">XML-RPC API version in integer representation. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00052">common.h:52</a></div></div>
<div class="ttc" id="common_8h_html_a67e3a5e6d1b103bd615c5de411177239"><div class="ttname"><a href="common_8h.html#a67e3a5e6d1b103bd615c5de411177239">FLOWGRIND_VERSION</a></div><div class="ttdeci">#define FLOWGRIND_VERSION</div><div class="ttdoc">Flowgrind version number. </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00044">common.h:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1ed767ac2965ae35b09e74b50b2ba9a5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static xmlrpc_value* method_stop_flow </td>
          <td>(</td>
          <td class="paramtype">xmlrpc_env *const&#160;</td>
          <td class="paramname"><em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">xmlrpc_value *const&#160;</td>
          <td class="paramname"><em>param_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *const&#160;</td>
          <td class="paramname"><em>user_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="fg__rpc__server_8c_source.html#l00623">623</a> of file <a class="el" href="fg__rpc__server_8c_source.html">fg_rpc_server.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;{</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <a class="code" href="fg__definitions_8h.html#a239dd5192fcd165ce89d2c6d08e34993">UNUSED_ARGUMENT</a>(user_data);</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <span class="keywordtype">int</span> rc;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        xmlrpc_value *ret = 0;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <span class="keywordtype">int</span> flow_id;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="keyword">struct </span><a class="code" href="structrequest__stop__flow.html">request_stop_flow</a> *<a class="code" href="structrequest.html">request</a> = 0;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_WARNING, <span class="stringliteral">&quot;method stop_flow called&quot;</span>);</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="comment">/* Parse our argument array. */</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        xmlrpc_decompose_value(env, param_array, <span class="stringliteral">&quot;({s:i,*})&quot;</span>,</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                <span class="comment">/* flow id */</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                <span class="stringliteral">&quot;flow_id&quot;</span>, &amp;flow_id);</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="keywordflow">if</span> (env-&gt;fault_occurred)</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        request = malloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrequest__stop__flow.html">request_stop_flow</a>));</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        request-&gt;<a class="code" href="structrequest__stop__flow.html#a927dcac0992e1170489ba6174baf9f28">flow_id</a> = <a class="code" href="structrequest__stop__flow.html#a927dcac0992e1170489ba6174baf9f28">flow_id</a>;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        rc = <a class="code" href="daemon_8c.html#a4271388fd018c3d910e4839b3747df96">dispatch_request</a>((<span class="keyword">struct</span> request*)request, <a class="code" href="daemon_8h.html#a3ce8d4ae1e4221490780ddcf1e48191c">REQUEST_STOP_FLOW</a>);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <span class="keywordflow">if</span> (rc == -1)</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                XMLRPC_FAIL(env, XMLRPC_INTERNAL_ERROR, request-&gt;<a class="code" href="structrequest__stop__flow.html#a232644fdf28b2cda8d2565c23aabc4f7">r</a>.<a class="code" href="structrequest.html#acc214191f4fbfabdedf789adc862b393">error</a>); <span class="comment">/* goto cleanup on failure */</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        <span class="comment">/* Return our result. */</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        ret = xmlrpc_build_value(env, <span class="stringliteral">&quot;()&quot;</span>);</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;cleanup:</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="keywordflow">if</span> (request)</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                <a class="code" href="fg__definitions_8h.html#a9735559a214ac1d8d9f8ceddfaeca672">free_all</a>(request-&gt;<a class="code" href="structrequest__stop__flow.html#a232644fdf28b2cda8d2565c23aabc4f7">r</a>.<a class="code" href="structrequest.html#acc214191f4fbfabdedf789adc862b393">error</a>, request);</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="keywordflow">if</span> (env-&gt;fault_occurred)</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                <a class="code" href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a>(LOG_WARNING, <span class="stringliteral">&quot;method stop_flow failed: %s&quot;</span>,</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                        env-&gt;fault_string);</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_WARNING, <span class="stringliteral">&quot;method stop_flow successful&quot;</span>);</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;}</div><div class="ttc" id="fg__log_8c_html_a2aea54bb4eab90a69510db34326d82f4"><div class="ttname"><a href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a></div><div class="ttdeci">void logging(int priority, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="fg__log_8c_source.html#l00069">fg_log.c:69</a></div></div>
<div class="ttc" id="structrequest__stop__flow_html_a232644fdf28b2cda8d2565c23aabc4f7"><div class="ttname"><a href="structrequest__stop__flow.html#a232644fdf28b2cda8d2565c23aabc4f7">request_stop_flow::r</a></div><div class="ttdeci">struct request r</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00229">daemon.h:229</a></div></div>
<div class="ttc" id="daemon_8h_html_a3ce8d4ae1e4221490780ddcf1e48191c"><div class="ttname"><a href="daemon_8h.html#a3ce8d4ae1e4221490780ddcf1e48191c">REQUEST_STOP_FLOW</a></div><div class="ttdeci">#define REQUEST_STOP_FLOW</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00176">daemon.h:176</a></div></div>
<div class="ttc" id="daemon_8c_html_a4271388fd018c3d910e4839b3747df96"><div class="ttname"><a href="daemon_8c.html#a4271388fd018c3d910e4839b3747df96">dispatch_request</a></div><div class="ttdeci">int dispatch_request(struct request *request, int type)</div><div class="ttdoc">Dispatch a request to daemon loop. </div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l01485">daemon.c:1485</a></div></div>
<div class="ttc" id="structrequest__stop__flow_html"><div class="ttname"><a href="structrequest__stop__flow.html">request_stop_flow</a></div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00227">daemon.h:227</a></div></div>
<div class="ttc" id="structrequest__stop__flow_html_a927dcac0992e1170489ba6174baf9f28"><div class="ttname"><a href="structrequest__stop__flow.html#a927dcac0992e1170489ba6174baf9f28">request_stop_flow::flow_id</a></div><div class="ttdeci">int flow_id</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00231">daemon.h:231</a></div></div>
<div class="ttc" id="debug_8h_html_ae420d5a1d63f99c6a2a386c4eea54250"><div class="ttname"><a href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a></div><div class="ttdeci">#define DEBUG_MSG(LVL, MSG,...)</div><div class="ttdoc">Print debug message to standard error. </div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00049">debug.h:49</a></div></div>
<div class="ttc" id="structrequest_html_acc214191f4fbfabdedf789adc862b393"><div class="ttname"><a href="structrequest.html#acc214191f4fbfabdedf789adc862b393">request::error</a></div><div class="ttdeci">char * error</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00187">daemon.h:187</a></div></div>
<div class="ttc" id="fg__definitions_8h_html_a239dd5192fcd165ce89d2c6d08e34993"><div class="ttname"><a href="fg__definitions_8h.html#a239dd5192fcd165ce89d2c6d08e34993">UNUSED_ARGUMENT</a></div><div class="ttdeci">#define UNUSED_ARGUMENT(x)</div><div class="ttdoc">Suppress warning for unused argument. </div><div class="ttdef"><b>Definition:</b> <a href="fg__definitions_8h_source.html#l00038">fg_definitions.h:38</a></div></div>
<div class="ttc" id="fg__definitions_8h_html_a9735559a214ac1d8d9f8ceddfaeca672"><div class="ttname"><a href="fg__definitions_8h.html#a9735559a214ac1d8d9f8ceddfaeca672">free_all</a></div><div class="ttdeci">#define free_all(...)</div><div class="ttdoc">To free() an arbitrary number of variables. </div><div class="ttdef"><b>Definition:</b> <a href="fg__definitions_8h_source.html#l00059">fg_definitions.h:59</a></div></div>
<div class="ttc" id="structrequest_html"><div class="ttname"><a href="structrequest.html">request</a></div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00179">daemon.h:179</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abf5fc98d4e3624c681e18494a085db84"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void run_rpc_server </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfg__rpc__server.html">fg_rpc_server</a> *&#160;</td>
          <td class="paramname"><em>server</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enters the xmlrpc server mainloop. </p>

<p>Definition at line <a class="el" href="fg__rpc__server_8c_source.html#l00878">878</a> of file <a class="el" href="fg__rpc__server_8c_source.html">fg_rpc_server.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;{</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        xmlrpc_env *env = &amp;(server-&gt;<a class="code" href="structfg__rpc__server.html#a8836ac2554cec646a01a160eab391d45">env</a>);</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        xmlrpc_server_abyss(env, &amp;(server-&gt;<a class="code" href="structfg__rpc__server.html#a7d67f166831ed00d0eefffe7e0fc1487">parms</a>), XMLRPC_APSIZE(socket_handle));</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        <span class="keywordflow">if</span> (env-&gt;fault_occurred)</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                <a class="code" href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a>(LOG_ALERT, <span class="stringliteral">&quot;XML-RPC Fault: %s (%d)&quot;</span>, env-&gt;fault_string,</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                        env-&gt;fault_code);</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        <span class="comment">/* xmlrpc_server_abyss() never returns */</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;}</div><div class="ttc" id="fg__log_8c_html_a2aea54bb4eab90a69510db34326d82f4"><div class="ttname"><a href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a></div><div class="ttdeci">void logging(int priority, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="fg__log_8c_source.html#l00069">fg_log.c:69</a></div></div>
<div class="ttc" id="structfg__rpc__server_html_a7d67f166831ed00d0eefffe7e0fc1487"><div class="ttname"><a href="structfg__rpc__server.html#a7d67f166831ed00d0eefffe7e0fc1487">fg_rpc_server::parms</a></div><div class="ttdeci">xmlrpc_server_abyss_parms parms</div><div class="ttdoc">Parameters of the XMLrpc server. </div><div class="ttdef"><b>Definition:</b> <a href="fg__rpc__server_8h_source.html#l00054">fg_rpc_server.h:54</a></div></div>
<div class="ttc" id="structfg__rpc__server_html_a8836ac2554cec646a01a160eab391d45"><div class="ttname"><a href="structfg__rpc__server.html#a8836ac2554cec646a01a160eab391d45">fg_rpc_server::env</a></div><div class="ttdeci">xmlrpc_env env</div><div class="ttdoc">Environment used by the Abyss server. </div><div class="ttdef"><b>Definition:</b> <a href="fg__rpc__server_8h_source.html#l00052">fg_rpc_server.h:52</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa474434b5dc6f7e1a4ca9af98382c37f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static xmlrpc_value* start_flows </td>
          <td>(</td>
          <td class="paramtype">xmlrpc_env *const&#160;</td>
          <td class="paramname"><em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">xmlrpc_value *const&#160;</td>
          <td class="paramname"><em>param_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *const&#160;</td>
          <td class="paramname"><em>user_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="fg__rpc__server_8c_source.html#l00462">462</a> of file <a class="el" href="fg__rpc__server_8c_source.html">fg_rpc_server.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;{</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <a class="code" href="fg__definitions_8h.html#a239dd5192fcd165ce89d2c6d08e34993">UNUSED_ARGUMENT</a>(user_data);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="keywordtype">int</span> rc;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        xmlrpc_value *ret = 0;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="keywordtype">int</span> start_timestamp;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keyword">struct </span><a class="code" href="structrequest__start__flows.html">request_start_flows</a> *<a class="code" href="structrequest.html">request</a> = 0;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_WARNING, <span class="stringliteral">&quot;method start_flows called&quot;</span>);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <span class="comment">/* Parse our argument array. */</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        xmlrpc_decompose_value(env, param_array, <span class="stringliteral">&quot;({s:i,*})&quot;</span>,</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                <span class="comment">/* general settings */</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                <span class="stringliteral">&quot;start_timestamp&quot;</span>, &amp;start_timestamp);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <span class="keywordflow">if</span> (env-&gt;fault_occurred)</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        request = malloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrequest__start__flows.html">request_start_flows</a>));</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        request-&gt;<a class="code" href="structrequest__start__flows.html#a86a1fdcb0c764460c5fb309dccd1f223">start_timestamp</a> = <a class="code" href="structrequest__start__flows.html#a86a1fdcb0c764460c5fb309dccd1f223">start_timestamp</a>;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        rc = <a class="code" href="daemon_8c.html#a4271388fd018c3d910e4839b3747df96">dispatch_request</a>((<span class="keyword">struct</span> request*)request, <a class="code" href="daemon_8h.html#a03812c2ffe8d7c7ee20036c7ff10debb">REQUEST_START_FLOWS</a>);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="keywordflow">if</span> (rc == -1)</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                XMLRPC_FAIL(env, XMLRPC_INTERNAL_ERROR, request-&gt;<a class="code" href="structrequest__start__flows.html#a6e048c5e363ab876a665e6e95d9bd611">r</a>.<a class="code" href="structrequest.html#acc214191f4fbfabdedf789adc862b393">error</a>); <span class="comment">/* goto cleanup on failure */</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="comment">/* Return our result. */</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        ret = xmlrpc_build_value(env, <span class="stringliteral">&quot;i&quot;</span>, 0);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;cleanup:</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="keywordflow">if</span> (request)</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                <a class="code" href="fg__definitions_8h.html#a9735559a214ac1d8d9f8ceddfaeca672">free_all</a>(request-&gt;<a class="code" href="structrequest__start__flows.html#a6e048c5e363ab876a665e6e95d9bd611">r</a>.<a class="code" href="structrequest.html#acc214191f4fbfabdedf789adc862b393">error</a>, request);</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="keywordflow">if</span> (env-&gt;fault_occurred)</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                <a class="code" href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a>(LOG_WARNING, <span class="stringliteral">&quot;method start_flows failed: %s&quot;</span>,</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                        env-&gt;fault_string);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_WARNING, <span class="stringliteral">&quot;method start_flows successful&quot;</span>);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;}</div><div class="ttc" id="fg__log_8c_html_a2aea54bb4eab90a69510db34326d82f4"><div class="ttname"><a href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a></div><div class="ttdeci">void logging(int priority, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="fg__log_8c_source.html#l00069">fg_log.c:69</a></div></div>
<div class="ttc" id="structrequest__start__flows_html_a6e048c5e363ab876a665e6e95d9bd611"><div class="ttname"><a href="structrequest__start__flows.html#a6e048c5e363ab876a665e6e95d9bd611">request_start_flows::r</a></div><div class="ttdeci">struct request r</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00222">daemon.h:222</a></div></div>
<div class="ttc" id="daemon_8c_html_a4271388fd018c3d910e4839b3747df96"><div class="ttname"><a href="daemon_8c.html#a4271388fd018c3d910e4839b3747df96">dispatch_request</a></div><div class="ttdeci">int dispatch_request(struct request *request, int type)</div><div class="ttdoc">Dispatch a request to daemon loop. </div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l01485">daemon.c:1485</a></div></div>
<div class="ttc" id="debug_8h_html_ae420d5a1d63f99c6a2a386c4eea54250"><div class="ttname"><a href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a></div><div class="ttdeci">#define DEBUG_MSG(LVL, MSG,...)</div><div class="ttdoc">Print debug message to standard error. </div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00049">debug.h:49</a></div></div>
<div class="ttc" id="structrequest_html_acc214191f4fbfabdedf789adc862b393"><div class="ttname"><a href="structrequest.html#acc214191f4fbfabdedf789adc862b393">request::error</a></div><div class="ttdeci">char * error</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00187">daemon.h:187</a></div></div>
<div class="ttc" id="fg__definitions_8h_html_a239dd5192fcd165ce89d2c6d08e34993"><div class="ttname"><a href="fg__definitions_8h.html#a239dd5192fcd165ce89d2c6d08e34993">UNUSED_ARGUMENT</a></div><div class="ttdeci">#define UNUSED_ARGUMENT(x)</div><div class="ttdoc">Suppress warning for unused argument. </div><div class="ttdef"><b>Definition:</b> <a href="fg__definitions_8h_source.html#l00038">fg_definitions.h:38</a></div></div>
<div class="ttc" id="daemon_8h_html_a03812c2ffe8d7c7ee20036c7ff10debb"><div class="ttname"><a href="daemon_8h.html#a03812c2ffe8d7c7ee20036c7ff10debb">REQUEST_START_FLOWS</a></div><div class="ttdeci">#define REQUEST_START_FLOWS</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00175">daemon.h:175</a></div></div>
<div class="ttc" id="fg__definitions_8h_html_a9735559a214ac1d8d9f8ceddfaeca672"><div class="ttname"><a href="fg__definitions_8h.html#a9735559a214ac1d8d9f8ceddfaeca672">free_all</a></div><div class="ttdeci">#define free_all(...)</div><div class="ttdoc">To free() an arbitrary number of variables. </div><div class="ttdef"><b>Definition:</b> <a href="fg__definitions_8h_source.html#l00059">fg_definitions.h:59</a></div></div>
<div class="ttc" id="structrequest__start__flows_html"><div class="ttname"><a href="structrequest__start__flows.html">request_start_flows</a></div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00220">daemon.h:220</a></div></div>
<div class="ttc" id="structrequest__start__flows_html_a86a1fdcb0c764460c5fb309dccd1f223"><div class="ttname"><a href="structrequest__start__flows.html#a86a1fdcb0c764460c5fb309dccd1f223">request_start_flows::start_timestamp</a></div><div class="ttdeci">int start_timestamp</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00224">daemon.h:224</a></div></div>
<div class="ttc" id="structrequest_html"><div class="ttname"><a href="structrequest.html">request</a></div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00179">daemon.h:179</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="fg__rpc__server_8c.html">fg_rpc_server.c</a></li>
    <li class="footer">Generated on Mon Sep 19 2016 13:59:32 for Flowgrind by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
