<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Flowgrind: src/fg_time.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="flowgrind.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Flowgrind
   </div>
   <div id="projectbrief">Advanced TCP traffic generator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('fg__time_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">fg_time.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Timing related routines used by Flowgrind.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="config_8h_source.html">config.h</a>&quot;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &quot;<a class="el" href="fg__time_8h_source.html">fg_time.h</a>&quot;</code><br />
</div>
<p><a href="fg__time_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4c95f4c37416a9bf8f8de5d0e120e478"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fg__time_8c.html#a4c95f4c37416a9bf8f8de5d0e120e478">ctimenow</a> (bool ns)</td></tr>
<tr class="memdesc:a4c95f4c37416a9bf8f8de5d0e120e478"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the current wall-clock time as null-terminated string.  <a href="#a4c95f4c37416a9bf8f8de5d0e120e478">More...</a><br /></td></tr>
<tr class="separator:a4c95f4c37416a9bf8f8de5d0e120e478"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e6839ffd004b08c17d7343741b486d0"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fg__time_8c.html#a6e6839ffd004b08c17d7343741b486d0">ctimenow_r</a> (char *buf, size_t size, bool ns)</td></tr>
<tr class="memdesc:a6e6839ffd004b08c17d7343741b486d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the current wall-clock time as null-terminated string.  <a href="#a6e6839ffd004b08c17d7343741b486d0">More...</a><br /></td></tr>
<tr class="separator:a6e6839ffd004b08c17d7343741b486d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06445885dfc74c6c680d6d02055c5403"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fg__time_8c.html#a06445885dfc74c6c680d6d02055c5403">ctimespec</a> (const struct timespec *tp, bool ns)</td></tr>
<tr class="memdesc:a06445885dfc74c6c680d6d02055c5403"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts timespec struct <code>tp</code> into a null-terminated string.  <a href="#a06445885dfc74c6c680d6d02055c5403">More...</a><br /></td></tr>
<tr class="separator:a06445885dfc74c6c680d6d02055c5403"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a171ccad0a7b8941cc4a1f366c2e34c4c"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fg__time_8c.html#a171ccad0a7b8941cc4a1f366c2e34c4c">ctimespec_r</a> (const struct timespec *tp, char *buf, size_t size, bool ns)</td></tr>
<tr class="memdesc:a171ccad0a7b8941cc4a1f366c2e34c4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts timespec struct <code>tp</code> into a null-terminated string.  <a href="#a171ccad0a7b8941cc4a1f366c2e34c4c">More...</a><br /></td></tr>
<tr class="separator:a171ccad0a7b8941cc4a1f366c2e34c4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2b9db9a31fa442023443d234787ef78"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fg__time_8c.html#ac2b9db9a31fa442023443d234787ef78">gettime</a> (struct timespec *tp)</td></tr>
<tr class="memdesc:ac2b9db9a31fa442023443d234787ef78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the current wall-clock time with nanosecond precision.  <a href="#ac2b9db9a31fa442023443d234787ef78">More...</a><br /></td></tr>
<tr class="separator:ac2b9db9a31fa442023443d234787ef78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbfce1fdd51fb1cc83497fb85a021dc4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fg__time_8c.html#abbfce1fdd51fb1cc83497fb85a021dc4">normalize_tp</a> (struct timespec *tp)</td></tr>
<tr class="memdesc:abbfce1fdd51fb1cc83497fb85a021dc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Normalizes timespec struct <code>tp</code>.  <a href="#abbfce1fdd51fb1cc83497fb85a021dc4">More...</a><br /></td></tr>
<tr class="separator:abbfce1fdd51fb1cc83497fb85a021dc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5017d8e7d42049ef923057b5a02404be"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fg__time_8c.html#a5017d8e7d42049ef923057b5a02404be">time_add</a> (struct timespec *tp, double seconds)</td></tr>
<tr class="memdesc:a5017d8e7d42049ef923057b5a02404be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add an amount of time <code>seconds</code> to a specific point in time <code>tp</code>.  <a href="#a5017d8e7d42049ef923057b5a02404be">More...</a><br /></td></tr>
<tr class="separator:a5017d8e7d42049ef923057b5a02404be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ce08f00b1930420282aa6422ce66f24"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fg__time_8c.html#a1ce08f00b1930420282aa6422ce66f24">time_diff</a> (const struct timespec *tp1, const struct timespec *tp2)</td></tr>
<tr class="memdesc:a1ce08f00b1930420282aa6422ce66f24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the time difference between two the specific points in time <code>tp1</code> and <code>tp2</code>.  <a href="#a1ce08f00b1930420282aa6422ce66f24">More...</a><br /></td></tr>
<tr class="separator:a1ce08f00b1930420282aa6422ce66f24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a255d1a882171eae755af0936c3d78951"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fg__time_8c.html#a255d1a882171eae755af0936c3d78951">time_diff_now</a> (const struct timespec *tp)</td></tr>
<tr class="memdesc:a255d1a882171eae755af0936c3d78951"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns time difference between now and the specific point in time <code>tp</code>.  <a href="#a255d1a882171eae755af0936c3d78951">More...</a><br /></td></tr>
<tr class="separator:a255d1a882171eae755af0936c3d78951"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a801431f54cf89b9f658e3e29b2bba0fe"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fg__time_8c.html#a801431f54cf89b9f658e3e29b2bba0fe">time_is_after</a> (const struct timespec *tp1, const struct timespec *tp2)</td></tr>
<tr class="memdesc:a801431f54cf89b9f658e3e29b2bba0fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if second point in time <code>tp2</code> is chronologically after the first point in time <code>tp1</code>.  <a href="#a801431f54cf89b9f658e3e29b2bba0fe">More...</a><br /></td></tr>
<tr class="separator:a801431f54cf89b9f658e3e29b2bba0fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Timing related routines used by Flowgrind. </p>

<p>Definition in file <a class="el" href="fg__time_8c_source.html">fg_time.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a4c95f4c37416a9bf8f8de5d0e120e478"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ctimenow </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>ns</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the current wall-clock time as null-terminated string. </p>
<p>The function returns a pointer to static data and hence is not thread-safe. The thread-safe version is <a class="el" href="fg__time_8h.html#a6e6839ffd004b08c17d7343741b486d0" title="Returns the current wall-clock time as null-terminated string. ">ctimenow_r()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ns</td><td>if returned time string should have nanosecond precision </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string of the form '2013-12-09-12:00:48[.34369902]' </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="fg__time_8h.html#a6e6839ffd004b08c17d7343741b486d0" title="Returns the current wall-clock time as null-terminated string. ">ctimenow_r</a> </dd></dl>

<p>Definition at line <a class="el" href="fg__time_8c_source.html#l00056">56</a> of file <a class="el" href="fg__time_8c_source.html">fg_time.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;{</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keyword">struct </span>timespec now;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <a class="code" href="fg__time_8c.html#ac2b9db9a31fa442023443d234787ef78">gettime</a>(&amp;now);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="fg__time_8c.html#a06445885dfc74c6c680d6d02055c5403">ctimespec</a>(&amp;now, ns);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;}</div><div class="ttc" id="fg__time_8c_html_ac2b9db9a31fa442023443d234787ef78"><div class="ttname"><a href="fg__time_8c.html#ac2b9db9a31fa442023443d234787ef78">gettime</a></div><div class="ttdeci">int gettime(struct timespec *tp)</div><div class="ttdoc">Returns the current wall-clock time with nanosecond precision. </div><div class="ttdef"><b>Definition:</b> <a href="fg__time_8c_source.html#l00145">fg_time.c:145</a></div></div>
<div class="ttc" id="fg__time_8c_html_a06445885dfc74c6c680d6d02055c5403"><div class="ttname"><a href="fg__time_8c.html#a06445885dfc74c6c680d6d02055c5403">ctimespec</a></div><div class="ttdeci">const char * ctimespec(const struct timespec *tp, bool ns)</div><div class="ttdoc">Converts timespec struct tp into a null-terminated string. </div><div class="ttdef"><b>Definition:</b> <a href="fg__time_8c_source.html#l00086">fg_time.c:86</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6e6839ffd004b08c17d7343741b486d0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ctimenow_r </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>ns</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the current wall-clock time as null-terminated string. </p>
<p>It stores the string in a user-supplied buffer <code>buf</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">buf</td><td>buffer with room for at least 30 bytes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>size of the buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ns</td><td>if returned time string should have nanosecond precision </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string of the form '2013-12-09-12:00:48[.34369902]' </dd></dl>

<p>Definition at line <a class="el" href="fg__time_8c_source.html#l00047">47</a> of file <a class="el" href="fg__time_8c_source.html">fg_time.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keyword">struct </span>timespec now;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <a class="code" href="fg__time_8c.html#ac2b9db9a31fa442023443d234787ef78">gettime</a>(&amp;now);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="fg__time_8c.html#a171ccad0a7b8941cc4a1f366c2e34c4c">ctimespec_r</a>(&amp;now, buf, size, ns);</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div><div class="ttc" id="fg__time_8c_html_a171ccad0a7b8941cc4a1f366c2e34c4c"><div class="ttname"><a href="fg__time_8c.html#a171ccad0a7b8941cc4a1f366c2e34c4c">ctimespec_r</a></div><div class="ttdeci">const char * ctimespec_r(const struct timespec *tp, char *buf, size_t size, bool ns)</div><div class="ttdoc">Converts timespec struct tp into a null-terminated string. </div><div class="ttdef"><b>Definition:</b> <a href="fg__time_8c_source.html#l00066">fg_time.c:66</a></div></div>
<div class="ttc" id="fg__time_8c_html_ac2b9db9a31fa442023443d234787ef78"><div class="ttname"><a href="fg__time_8c.html#ac2b9db9a31fa442023443d234787ef78">gettime</a></div><div class="ttdeci">int gettime(struct timespec *tp)</div><div class="ttdoc">Returns the current wall-clock time with nanosecond precision. </div><div class="ttdef"><b>Definition:</b> <a href="fg__time_8c_source.html#l00145">fg_time.c:145</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a06445885dfc74c6c680d6d02055c5403"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ctimespec </td>
          <td>(</td>
          <td class="paramtype">const struct timespec *&#160;</td>
          <td class="paramname"><em>tp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>ns</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts timespec struct <code>tp</code> into a null-terminated string. </p>
<p>The function returns a pointer to static data and hence is not thread-safe. The thread-safe version is <a class="el" href="fg__time_8h.html#a171ccad0a7b8941cc4a1f366c2e34c4c" title="Converts timespec struct tp into a null-terminated string. ">ctimespec_r()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tp</td><td>point in time </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ns</td><td>if returned time string should have nanosecond precision </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string of the form '2013-12-09-12:00:48[.34369902]' </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="fg__time_8h.html#a171ccad0a7b8941cc4a1f366c2e34c4c" title="Converts timespec struct tp into a null-terminated string. ">ctimespec_r</a> </dd></dl>

<p>Definition at line <a class="el" href="fg__time_8c_source.html#l00086">86</a> of file <a class="el" href="fg__time_8c_source.html">fg_time.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;{</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keyword">static</span> <span class="keywordtype">char</span> buf[30];</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <a class="code" href="fg__time_8c.html#a171ccad0a7b8941cc4a1f366c2e34c4c">ctimespec_r</a>(tp, buf, <span class="keyword">sizeof</span>(buf), ns);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">return</span> buf;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;}</div><div class="ttc" id="fg__time_8c_html_a171ccad0a7b8941cc4a1f366c2e34c4c"><div class="ttname"><a href="fg__time_8c.html#a171ccad0a7b8941cc4a1f366c2e34c4c">ctimespec_r</a></div><div class="ttdeci">const char * ctimespec_r(const struct timespec *tp, char *buf, size_t size, bool ns)</div><div class="ttdoc">Converts timespec struct tp into a null-terminated string. </div><div class="ttdef"><b>Definition:</b> <a href="fg__time_8c_source.html#l00066">fg_time.c:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a171ccad0a7b8941cc4a1f366c2e34c4c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ctimespec_r </td>
          <td>(</td>
          <td class="paramtype">const struct timespec *&#160;</td>
          <td class="paramname"><em>tp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>ns</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts timespec struct <code>tp</code> into a null-terminated string. </p>
<p>It stores the string in a user-supplied buffer <code>buf</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tp</td><td>point in time </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buf</td><td>buffer with room for at least 30 bytes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>size of the buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ns</td><td>if returned time string should have nanosecond precision </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string of the form '2013-12-09-12:00:48i[.34369902]' </dd></dl>

<p>Definition at line <a class="el" href="fg__time_8c_source.html#l00066">66</a> of file <a class="el" href="fg__time_8c_source.html">fg_time.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;{</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keyword">struct </span>tm tm;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="comment">/* Converts the calendar time to broken-down time representation,</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">         * expressed relative to the user&#39;s specified timezone */</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        tzset();</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        localtime_r(&amp;tp-&gt;tv_sec, &amp;tm);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="comment">/* Converts broken-down time representation into a string */</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keywordtype">size_t</span> len = strftime(buf, size, <span class="stringliteral">&quot;%F-%T&quot;</span>, &amp;tm);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="comment">/* Append nanoseconds to string */</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordflow">if</span> (ns)</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                snprintf(buf+len, size-len, <span class="stringliteral">&quot;.%09ld&quot;</span>, tp-&gt;tv_nsec);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keywordflow">return</span> buf;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac2b9db9a31fa442023443d234787ef78"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gettime </td>
          <td>(</td>
          <td class="paramtype">struct timespec *&#160;</td>
          <td class="paramname"><em>tp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the current wall-clock time with nanosecond precision. </p>
<p>Since the returned time is retrieved from a system-wide clock that measures real time, the time is may be affected by discontinuous jumps in the system time (e.g., if admin manually changes the clock), and by the incremental adjustments performed by NTP.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">tp</td><td>current time in seconds and nanoseconds since the Epoch </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>return 0 for success, or -1 for failure </dd></dl>

<p>Definition at line <a class="el" href="fg__time_8c_source.html#l00145">145</a> of file <a class="el" href="fg__time_8c_source.html">fg_time.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;{</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keyword">static</span> <span class="keyword">struct </span>timespec res = {.tv_sec = 0, .tv_nsec = 0};</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="comment">/* Find out clock resolution. Will only be retrieved on first call */</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">if</span> (!res.tv_sec &amp;&amp; !res.tv_nsec) {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                clock_getres(CLOCK_REALTIME, &amp;res);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                <span class="comment">/* Clock resolution is lower than expected (1ns) */</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                assert(res.tv_nsec == 1);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="comment">/* Get wall-clock time */</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">return</span> clock_gettime(CLOCK_REALTIME, tp);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abbfce1fdd51fb1cc83497fb85a021dc4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool normalize_tp </td>
          <td>(</td>
          <td class="paramtype">struct timespec *&#160;</td>
          <td class="paramname"><em>tp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Normalizes timespec struct <code>tp</code>. </p>
<p>Ensures that the equation 0 &lt;= tp-&gt;tv_nsec &lt; NSEC_PER_SEC holds, meaning that the amount of nanoseconds is not negative less than one second.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tp</td><td>point in time </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if timespec struct was already normalized, otherwise false </dd></dl>

<p>Definition at line <a class="el" href="fg__time_8c_source.html#l00119">119</a> of file <a class="el" href="fg__time_8c_source.html">fg_time.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;{</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordtype">bool</span> normalized = <span class="keyword">true</span>;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordflow">while</span> (tp-&gt;tv_nsec &gt;= (<span class="keywordtype">long</span>) <a class="code" href="fg__time_8h.html#a0501e82515b2bdf36453c4cc80f5e0cc">NSEC_PER_SEC</a>) {</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                tp-&gt;tv_nsec -= (long) NSEC_PER_SEC;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                tp-&gt;tv_sec++;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                normalized = <span class="keyword">false</span>;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">while</span> (tp-&gt;tv_nsec &lt; 0) {</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                tp-&gt;tv_nsec += (long) NSEC_PER_SEC;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                tp-&gt;tv_sec--;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                normalized = <span class="keyword">false</span>;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        }</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordflow">return</span> normalized;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div><div class="ttc" id="fg__time_8h_html_a0501e82515b2bdf36453c4cc80f5e0cc"><div class="ttname"><a href="fg__time_8h.html#a0501e82515b2bdf36453c4cc80f5e0cc">NSEC_PER_SEC</a></div><div class="ttdeci">#define NSEC_PER_SEC</div><div class="ttdoc">Number of nanoseconds per second. </div><div class="ttdef"><b>Definition:</b> <a href="fg__time_8h_source.html#l00041">fg_time.h:41</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5017d8e7d42049ef923057b5a02404be"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void time_add </td>
          <td>(</td>
          <td class="paramtype">struct timespec *&#160;</td>
          <td class="paramname"><em>tp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>seconds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add an amount of time <code>seconds</code> to a specific point in time <code>tp</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tp</td><td>point in time </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">seconds</td><td>amount of time in seconds </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="fg__time_8c_source.html#l00136">136</a> of file <a class="el" href="fg__time_8c_source.html">fg_time.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;{</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        tp-&gt;tv_sec += (time_t) seconds;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        tp-&gt;tv_nsec += (long) ((seconds - (time_t) seconds) * (<span class="keywordtype">long</span>) <a class="code" href="fg__time_8h.html#a0501e82515b2bdf36453c4cc80f5e0cc">NSEC_PER_SEC</a>);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <a class="code" href="fg__time_8c.html#abbfce1fdd51fb1cc83497fb85a021dc4">normalize_tp</a>(tp);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;}</div><div class="ttc" id="fg__time_8c_html_abbfce1fdd51fb1cc83497fb85a021dc4"><div class="ttname"><a href="fg__time_8c.html#abbfce1fdd51fb1cc83497fb85a021dc4">normalize_tp</a></div><div class="ttdeci">bool normalize_tp(struct timespec *tp)</div><div class="ttdoc">Normalizes timespec struct tp. </div><div class="ttdef"><b>Definition:</b> <a href="fg__time_8c_source.html#l00119">fg_time.c:119</a></div></div>
<div class="ttc" id="fg__time_8h_html_a0501e82515b2bdf36453c4cc80f5e0cc"><div class="ttname"><a href="fg__time_8h.html#a0501e82515b2bdf36453c4cc80f5e0cc">NSEC_PER_SEC</a></div><div class="ttdeci">#define NSEC_PER_SEC</div><div class="ttdoc">Number of nanoseconds per second. </div><div class="ttdef"><b>Definition:</b> <a href="fg__time_8h_source.html#l00041">fg_time.h:41</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1ce08f00b1930420282aa6422ce66f24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double time_diff </td>
          <td>(</td>
          <td class="paramtype">const struct timespec *&#160;</td>
          <td class="paramname"><em>tp1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct timespec *&#160;</td>
          <td class="paramname"><em>tp2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the time difference between two the specific points in time <code>tp1</code> and <code>tp2</code>. </p>
<p>Negative if the first point in time is chronologically after the second one.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tp1</td><td>point in time </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tp2</td><td>point in time </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>time difference in nanoseconds </dd></dl>

<p>Definition at line <a class="el" href="fg__time_8c_source.html#l00095">95</a> of file <a class="el" href="fg__time_8c_source.html">fg_time.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;{</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">return</span> (<span class="keywordtype">double</span>) (tp2-&gt;tv_sec - tp1-&gt;tv_sec)</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                + (<span class="keywordtype">double</span>) (tp2-&gt;tv_nsec - tp1-&gt;tv_nsec) / (<span class="keywordtype">long</span>) <a class="code" href="fg__time_8h.html#a0501e82515b2bdf36453c4cc80f5e0cc">NSEC_PER_SEC</a>;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;}</div><div class="ttc" id="fg__time_8h_html_a0501e82515b2bdf36453c4cc80f5e0cc"><div class="ttname"><a href="fg__time_8h.html#a0501e82515b2bdf36453c4cc80f5e0cc">NSEC_PER_SEC</a></div><div class="ttdeci">#define NSEC_PER_SEC</div><div class="ttdoc">Number of nanoseconds per second. </div><div class="ttdef"><b>Definition:</b> <a href="fg__time_8h_source.html#l00041">fg_time.h:41</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a255d1a882171eae755af0936c3d78951"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double time_diff_now </td>
          <td>(</td>
          <td class="paramtype">const struct timespec *&#160;</td>
          <td class="paramname"><em>tp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns time difference between now and the specific point in time <code>tp</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tp</td><td>point in time </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>time difference in nanoseconds </dd></dl>

<p>Definition at line <a class="el" href="fg__time_8c_source.html#l00101">101</a> of file <a class="el" href="fg__time_8c_source.html">fg_time.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;{</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keyword">struct </span>timespec now;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <a class="code" href="fg__time_8c.html#ac2b9db9a31fa442023443d234787ef78">gettime</a>(&amp;now);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordflow">return</span> (<span class="keywordtype">double</span>) (now.tv_sec - tp-&gt;tv_sec)</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                + (<span class="keywordtype">double</span>) (now.tv_nsec - tp-&gt;tv_nsec) / (<span class="keywordtype">long</span>) <a class="code" href="fg__time_8h.html#a0501e82515b2bdf36453c4cc80f5e0cc">NSEC_PER_SEC</a>;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;}</div><div class="ttc" id="fg__time_8c_html_ac2b9db9a31fa442023443d234787ef78"><div class="ttname"><a href="fg__time_8c.html#ac2b9db9a31fa442023443d234787ef78">gettime</a></div><div class="ttdeci">int gettime(struct timespec *tp)</div><div class="ttdoc">Returns the current wall-clock time with nanosecond precision. </div><div class="ttdef"><b>Definition:</b> <a href="fg__time_8c_source.html#l00145">fg_time.c:145</a></div></div>
<div class="ttc" id="fg__time_8h_html_a0501e82515b2bdf36453c4cc80f5e0cc"><div class="ttname"><a href="fg__time_8h.html#a0501e82515b2bdf36453c4cc80f5e0cc">NSEC_PER_SEC</a></div><div class="ttdeci">#define NSEC_PER_SEC</div><div class="ttdoc">Number of nanoseconds per second. </div><div class="ttdef"><b>Definition:</b> <a href="fg__time_8h_source.html#l00041">fg_time.h:41</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a801431f54cf89b9f658e3e29b2bba0fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool time_is_after </td>
          <td>(</td>
          <td class="paramtype">const struct timespec *&#160;</td>
          <td class="paramname"><em>tp1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct timespec *&#160;</td>
          <td class="paramname"><em>tp2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if second point in time <code>tp2</code> is chronologically after the first point in time <code>tp1</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tp1</td><td>point in time </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tp2</td><td>point in time </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true or false </dd></dl>

<p>Definition at line <a class="el" href="fg__time_8c_source.html#l00110">110</a> of file <a class="el" href="fg__time_8c_source.html">fg_time.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;{</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordflow">if</span> (tp1-&gt;tv_sec &gt; tp2-&gt;tv_sec)</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordflow">if</span> (tp1-&gt;tv_sec &lt; tp2-&gt;tv_sec)</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordflow">return</span> tp1-&gt;tv_nsec &gt; tp2-&gt;tv_nsec;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="fg__time_8c.html">fg_time.c</a></li>
    <li class="footer">Generated on Mon Sep 19 2016 13:59:32 for Flowgrind by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
